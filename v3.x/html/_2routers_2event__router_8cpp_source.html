<!-- This comment will put IE 6, 7 and 8 in quirks mode -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>GPGPU-Sim: v3.x/src/intersim2/routers/event_router.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javaScript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body onload='searchBox.OnSelectItem(0);'>
<!-- Generated by Doxygen 1.6.1 -->
<script type="text/javascript"><!--
var searchBox = new SearchBox("searchBox", "search",false,'Search');
--></script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <img id="MSearchSelect" src="search/search.png"
             onmouseover="return searchBox.OnSearchSelectShow()"
             onmouseout="return searchBox.OnSearchSelectHide()"
             alt=""/>
        <input type="text" id="MSearchField" value="Search" accesskey="S"
             onfocus="searchBox.OnSearchFieldFocus(true)" 
             onblur="searchBox.OnSearchFieldFocus(false)" 
             onkeyup="searchBox.OnSearchFieldChange(event)"/>
        <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
        </div>
      </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_c934b74ccb33d6b9bfd1e576787940d8.html">v3.x</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_da58ad9beee6988f697f1a76e412a52a.html">src</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_7e44b91c2d8bca2324eb4df0ed8bb374.html">intersim2</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_711254f66e42fa7a424b1ac87622c886.html">routers</a>
  </div>
</div>
<div class="contents">
<h1>event_router.cpp</h1><a href="_2routers_2event__router_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">// $Id: event_router.cpp 5188 2012-08-30 00:31:31Z dub $</span>
<a name="l00002"></a>00002 
<a name="l00003"></a>00003 <span class="comment">/*</span>
<a name="l00004"></a>00004 <span class="comment"> Copyright (c) 2007-2012, Trustees of The Leland Stanford Junior University</span>
<a name="l00005"></a>00005 <span class="comment"> All rights reserved.</span>
<a name="l00006"></a>00006 <span class="comment"></span>
<a name="l00007"></a>00007 <span class="comment"> Redistribution and use in source and binary forms, with or without</span>
<a name="l00008"></a>00008 <span class="comment"> modification, are permitted provided that the following conditions are met:</span>
<a name="l00009"></a>00009 <span class="comment"></span>
<a name="l00010"></a>00010 <span class="comment"> Redistributions of source code must retain the above copyright notice, this </span>
<a name="l00011"></a>00011 <span class="comment"> list of conditions and the following disclaimer.</span>
<a name="l00012"></a>00012 <span class="comment"> Redistributions in binary form must reproduce the above copyright notice, this</span>
<a name="l00013"></a>00013 <span class="comment"> list of conditions and the following disclaimer in the documentation and/or</span>
<a name="l00014"></a>00014 <span class="comment"> other materials provided with the distribution.</span>
<a name="l00015"></a>00015 <span class="comment"></span>
<a name="l00016"></a>00016 <span class="comment"> THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot; AND</span>
<a name="l00017"></a>00017 <span class="comment"> ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED</span>
<a name="l00018"></a>00018 <span class="comment"> WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE </span>
<a name="l00019"></a>00019 <span class="comment"> DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR</span>
<a name="l00020"></a>00020 <span class="comment"> ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES</span>
<a name="l00021"></a>00021 <span class="comment"> (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;</span>
<a name="l00022"></a>00022 <span class="comment"> LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON</span>
<a name="l00023"></a>00023 <span class="comment"> ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<a name="l00024"></a>00024 <span class="comment"> (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS</span>
<a name="l00025"></a>00025 <span class="comment"> SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00026"></a>00026 <span class="comment">*/</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;string&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;sstream&gt;</span>
<a name="l00030"></a>00030 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00031"></a>00031 <span class="preprocessor">#include &lt;cstdlib&gt;</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include &lt;cassert&gt;</span>
<a name="l00033"></a>00033 
<a name="l00034"></a>00034 <span class="preprocessor">#include &quot;event_router.hpp&quot;</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include &quot;stats.hpp&quot;</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include &quot;<a class="code" href="globals_8hpp.html">globals.hpp</a>&quot;</span>
<a name="l00037"></a>00037 
<a name="l00038"></a><a class="code" href="classEventRouter.html#a85ba8251c9761bf2c7f26b673fb39b17">00038</a> <a class="code" href="classEventRouter.html#a49443d82b0b7c236c4711a3aabe6f306">EventRouter::EventRouter</a>( <span class="keyword">const</span> <a class="code" href="classConfiguration.html">Configuration</a>&amp; config,
<a name="l00039"></a>00039             <a class="code" href="classModule.html">Module</a> *parent, <span class="keyword">const</span> <span class="keywordtype">string</span> &amp; name, <span class="keywordtype">int</span> <span class="keywordtype">id</span>,
<a name="l00040"></a>00040             <span class="keywordtype">int</span> inputs, <span class="keywordtype">int</span> outputs )
<a name="l00041"></a>00041   : <a class="code" href="classRouter.html">Router</a>( config,
<a name="l00042"></a>00042         parent, name,
<a name="l00043"></a>00043         id,
<a name="l00044"></a>00044         inputs, outputs )
<a name="l00045"></a>00045 {
<a name="l00046"></a>00046   ostringstream module_name;
<a name="l00047"></a>00047   
<a name="l00048"></a>00048   <a class="code" href="classEventRouter.html#a52586db8035c6e8f998be49230a5633d">_vcs</a>            = config.<a class="code" href="classConfiguration.html#a924090a06ca73bc53ed73c5f4f2cae27">GetInt</a>( <span class="stringliteral">&quot;num_vcs&quot;</span> );
<a name="l00049"></a>00049 
<a name="l00050"></a>00050   <span class="comment">// Cut-through mode --- packets are not broken</span>
<a name="l00051"></a>00051   <span class="comment">// up and input buffers are assumed to be </span>
<a name="l00052"></a>00052   <span class="comment">// expressed in units of maximum size packets.</span>
<a name="l00053"></a>00053   
<a name="l00054"></a>00054   <a class="code" href="classEventRouter.html#a4989d0bf33c1b8d1f1acb26af603b952">_vct</a>            = config.<a class="code" href="classConfiguration.html#a924090a06ca73bc53ed73c5f4f2cae27">GetInt</a>( <span class="stringliteral">&quot;vct&quot;</span> );
<a name="l00055"></a>00055 
<a name="l00056"></a>00056   <span class="comment">// Routing</span>
<a name="l00057"></a>00057 
<a name="l00058"></a>00058   <span class="keywordtype">string</span> rf = config.<a class="code" href="classConfiguration.html#a103c3ea43ae754ac4b0c15a53d86a48a">GetStr</a>(<span class="stringliteral">&quot;routing_function&quot;</span>) + <span class="stringliteral">&quot;_&quot;</span> + config.<a class="code" href="classConfiguration.html#a103c3ea43ae754ac4b0c15a53d86a48a">GetStr</a>(<span class="stringliteral">&quot;topology&quot;</span>);
<a name="l00059"></a>00059   map&lt;string, tRoutingFunction&gt;::iterator rf_iter = <a class="code" href="routefunc_8cpp.html#a0f29c5e50d61f6c53291c64c6e56ace4">gRoutingFunctionMap</a>.find(rf);
<a name="l00060"></a>00060   <span class="keywordflow">if</span>(rf_iter == <a class="code" href="routefunc_8cpp.html#a0f29c5e50d61f6c53291c64c6e56ace4">gRoutingFunctionMap</a>.end()) {
<a name="l00061"></a>00061     <a class="code" href="classModule.html#acfa9d0dc518853045e0d2356d138717f">Error</a>(<span class="stringliteral">&quot;Invalid routing function: &quot;</span> + rf);
<a name="l00062"></a>00062   }
<a name="l00063"></a>00063   <a class="code" href="classEventRouter.html#a52a0b1f1f3b4983ad935ea3217eb79c1">_rf</a> = rf_iter-&gt;second;
<a name="l00064"></a>00064 
<a name="l00065"></a>00065   <span class="comment">// Alloc VC&apos;s</span>
<a name="l00066"></a>00066 
<a name="l00067"></a>00067   <a class="code" href="classEventRouter.html#a9b9e0996ceb70b9677e66b77f8555ba7">_buf</a>.resize(<a class="code" href="classRouter.html#aba2966529ab67e97c23f458e9e6c56f2">_inputs</a>);
<a name="l00068"></a>00068   <a class="code" href="classEventRouter.html#aaa3e7b4d6314f8a0133cdf67c6afe62b">_active</a>.resize(<a class="code" href="classRouter.html#aba2966529ab67e97c23f458e9e6c56f2">_inputs</a>);
<a name="l00069"></a>00069 
<a name="l00070"></a>00070   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classRouter.html#aba2966529ab67e97c23f458e9e6c56f2">_inputs</a>; ++i ) {
<a name="l00071"></a>00071     module_name &lt;&lt; <span class="stringliteral">&quot;buf_&quot;</span> &lt;&lt; i;
<a name="l00072"></a>00072     <a class="code" href="classEventRouter.html#a9b9e0996ceb70b9677e66b77f8555ba7">_buf</a>[i] = <span class="keyword">new</span> <a class="code" href="classBuffer.html">Buffer</a>( config, <a class="code" href="classRouter.html#ab82f716767004c40fe8e3b8656371873">_outputs</a>, <span class="keyword">this</span>, module_name.str( ) );
<a name="l00073"></a>00073     module_name.seekp( 0, ios::beg );
<a name="l00074"></a>00074     <a class="code" href="classEventRouter.html#aaa3e7b4d6314f8a0133cdf67c6afe62b">_active</a>[i].resize(<a class="code" href="classEventRouter.html#a52586db8035c6e8f998be49230a5633d">_vcs</a>, <span class="keyword">false</span>);
<a name="l00075"></a>00075   }
<a name="l00076"></a>00076 
<a name="l00077"></a>00077   <span class="comment">// Alloc next VCs&apos; state</span>
<a name="l00078"></a>00078 
<a name="l00079"></a>00079   <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>.resize(<a class="code" href="classRouter.html#ab82f716767004c40fe8e3b8656371873">_outputs</a>);
<a name="l00080"></a>00080 
<a name="l00081"></a>00081   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> o = 0; o &lt; <a class="code" href="classRouter.html#ab82f716767004c40fe8e3b8656371873">_outputs</a>; ++o ) {
<a name="l00082"></a>00082     module_name &lt;&lt; <span class="stringliteral">&quot;output&quot;</span> &lt;&lt; o &lt;&lt; <span class="stringliteral">&quot;_vc_state&quot;</span>;
<a name="l00083"></a>00083     <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[o] = <span class="keyword">new</span> <a class="code" href="classEventNextVCState.html">EventNextVCState</a>(config, <span class="keyword">this</span>, module_name.str());
<a name="l00084"></a>00084     module_name.seekp( 0, ios::beg );
<a name="l00085"></a>00085   }
<a name="l00086"></a>00086 
<a name="l00087"></a>00087   <span class="comment">// Alloc arbiters</span>
<a name="l00088"></a>00088 
<a name="l00089"></a>00089   <a class="code" href="classEventRouter.html#a1bd0765ee6fe56109897680137ebc863">_arrival_arbiter</a>.resize(_outputs);
<a name="l00090"></a>00090 
<a name="l00091"></a>00091   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> o = 0; o &lt; _outputs; ++o ) {
<a name="l00092"></a>00092     module_name &lt;&lt; <span class="stringliteral">&quot;arrival_arb_output&quot;</span> &lt;&lt; o;
<a name="l00093"></a>00093     <a class="code" href="classEventRouter.html#a1bd0765ee6fe56109897680137ebc863">_arrival_arbiter</a>[o] = 
<a name="l00094"></a>00094       <span class="keyword">new</span> <a class="code" href="classPriorityArbiter.html">PriorityArbiter</a>( config, <span class="keyword">this</span>, module_name.str( ), _inputs );
<a name="l00095"></a>00095     module_name.seekp( 0, ios::beg );
<a name="l00096"></a>00096   }
<a name="l00097"></a>00097 
<a name="l00098"></a>00098   <a class="code" href="classEventRouter.html#a6850a1bf75735c5e597b60219dc6806f">_transport_arbiter</a>.resize(_inputs);
<a name="l00099"></a>00099 
<a name="l00100"></a>00100   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; i &lt; _inputs; ++i ) {
<a name="l00101"></a>00101     module_name &lt;&lt; <span class="stringliteral">&quot;transport_arb_input&quot;</span> &lt;&lt; i;
<a name="l00102"></a>00102     <a class="code" href="classEventRouter.html#a6850a1bf75735c5e597b60219dc6806f">_transport_arbiter</a>[i] = 
<a name="l00103"></a>00103       <span class="keyword">new</span> <a class="code" href="classPriorityArbiter.html">PriorityArbiter</a>( config, <span class="keyword">this</span>, module_name.str( ), _outputs );
<a name="l00104"></a>00104     module_name.seekp( 0, ios::beg );
<a name="l00105"></a>00105   }
<a name="l00106"></a>00106 
<a name="l00107"></a>00107   <span class="comment">// Alloc pipelines (to simulate processing/transmission delays)</span>
<a name="l00108"></a>00108 
<a name="l00109"></a>00109   <a class="code" href="classEventRouter.html#a270ecba4d458fe1f31eddc001e5fe2b7">_crossbar_pipe</a> = 
<a name="l00110"></a>00110     <span class="keyword">new</span> <a class="code" href="classPipelineFIFO.html">PipelineFIFO&lt;Flit&gt;</a>( <span class="keyword">this</span>, <span class="stringliteral">&quot;crossbar_pipeline&quot;</span>, _outputs, 
<a name="l00111"></a>00111                 <a class="code" href="classRouter.html#a1a5cbe3c84c191ccb1a3ed5c0f7b8323">_crossbar_delay</a> );
<a name="l00112"></a>00112 
<a name="l00113"></a>00113   <a class="code" href="classEventRouter.html#a1d6bb7dbab759a627ef735122becc9c2">_credit_pipe</a> =
<a name="l00114"></a>00114     <span class="keyword">new</span> <a class="code" href="classPipelineFIFO.html">PipelineFIFO&lt;Credit&gt;</a>( <span class="keyword">this</span>, <span class="stringliteral">&quot;credit_pipeline&quot;</span>, _inputs,
<a name="l00115"></a>00115                   <a class="code" href="classRouter.html#a6c3122c70894720c9456dd004bf96907">_credit_delay</a> );
<a name="l00116"></a>00116 
<a name="l00117"></a>00117   <a class="code" href="classEventRouter.html#a7e41defdf126e3cb7048c5fe65cb44ad">_arrival_pipe</a> =
<a name="l00118"></a>00118     <span class="keyword">new</span> <a class="code" href="classPipelineFIFO.html">PipelineFIFO&lt;tArrivalEvent&gt;</a>( <span class="keyword">this</span>, <span class="stringliteral">&quot;arrival_pipeline&quot;</span>, _inputs,
<a name="l00119"></a>00119                      0 <span class="comment">/* FIX THIS EVENTUALLY */</span>);
<a name="l00120"></a>00120 
<a name="l00121"></a>00121   <span class="comment">// Queues</span>
<a name="l00122"></a>00122 
<a name="l00123"></a>00123   <a class="code" href="classEventRouter.html#a6a5ed2511c12196bedf0ff54d2b4990f">_input_buffer</a>.resize(_inputs); 
<a name="l00124"></a>00124   <a class="code" href="classEventRouter.html#a4fb5fb835dbffe32917c2a8d6d274e1a">_output_buffer</a>.resize(_outputs); 
<a name="l00125"></a>00125 
<a name="l00126"></a>00126   <a class="code" href="classEventRouter.html#a85401afc7d37556f7a1d6e7a2a1e83f0">_in_cred_buffer</a>.resize(_inputs); 
<a name="l00127"></a>00127   <a class="code" href="classEventRouter.html#a0276d1b5a43f814fa24f4d10d9c9e6b0">_out_cred_buffer</a>.resize(_outputs);
<a name="l00128"></a>00128 
<a name="l00129"></a>00129   <a class="code" href="classEventRouter.html#a02745303a3ac7c276cfdf4095202f61d">_arrival_queue</a>.resize(_inputs);
<a name="l00130"></a>00130   <a class="code" href="classEventRouter.html#a07aed10ad1ef0dca3fe63dc4281a7584">_transport_queue</a>.resize(_outputs);
<a name="l00131"></a>00131 
<a name="l00132"></a>00132   <span class="comment">// Misc.</span>
<a name="l00133"></a>00133 
<a name="l00134"></a>00134   <a class="code" href="classEventRouter.html#ae9748e3424921fb9dc45f71c7361cca0">_transport_free</a>.resize(_inputs, <span class="keyword">true</span>);
<a name="l00135"></a>00135   <a class="code" href="classEventRouter.html#ae6df2e2f8d998b3395eece5c136e8975">_transport_match</a>.resize(_inputs, -1);
<a name="l00136"></a>00136 }
<a name="l00137"></a>00137 
<a name="l00138"></a>00138 <a class="code" href="classEventRouter.html#af02d64ba7843240247ed4ebb8bceb0c1">EventRouter::~EventRouter</a>( )
<a name="l00139"></a>00139 {
<a name="l00140"></a>00140   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classRouter.html#aba2966529ab67e97c23f458e9e6c56f2">_inputs</a>; ++i ) {
<a name="l00141"></a>00141     <span class="keyword">delete</span> <a class="code" href="classEventRouter.html#a9b9e0996ceb70b9677e66b77f8555ba7">_buf</a>[i];
<a name="l00142"></a>00142   }
<a name="l00143"></a>00143 
<a name="l00144"></a>00144   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> o = 0; o &lt; <a class="code" href="classRouter.html#ab82f716767004c40fe8e3b8656371873">_outputs</a>; ++o ) {
<a name="l00145"></a>00145     <span class="keyword">delete</span> <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[o];
<a name="l00146"></a>00146   }
<a name="l00147"></a>00147 
<a name="l00148"></a>00148   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> o = 0; o &lt; _outputs; ++o ) {
<a name="l00149"></a>00149     <span class="keyword">delete</span> <a class="code" href="classEventRouter.html#a1bd0765ee6fe56109897680137ebc863">_arrival_arbiter</a>[o];
<a name="l00150"></a>00150   }
<a name="l00151"></a>00151 
<a name="l00152"></a>00152   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; i &lt; _inputs; ++i ) {
<a name="l00153"></a>00153     <span class="keyword">delete</span> <a class="code" href="classEventRouter.html#a6850a1bf75735c5e597b60219dc6806f">_transport_arbiter</a>[i];
<a name="l00154"></a>00154   }
<a name="l00155"></a>00155 
<a name="l00156"></a>00156   <span class="keyword">delete</span> <a class="code" href="classEventRouter.html#a270ecba4d458fe1f31eddc001e5fe2b7">_crossbar_pipe</a>;
<a name="l00157"></a>00157   <span class="keyword">delete</span> <a class="code" href="classEventRouter.html#a1d6bb7dbab759a627ef735122becc9c2">_credit_pipe</a>;
<a name="l00158"></a>00158   <span class="keyword">delete</span> <a class="code" href="classEventRouter.html#a7e41defdf126e3cb7048c5fe65cb44ad">_arrival_pipe</a>;
<a name="l00159"></a>00159 }
<a name="l00160"></a>00160   
<a name="l00161"></a>00161 <span class="keywordtype">void</span> <a class="code" href="classEventRouter.html#ab0d660d4ba7f5dd1a39970339e73a1fd">EventRouter::ReadInputs</a>( )
<a name="l00162"></a>00162 {
<a name="l00163"></a>00163   <a class="code" href="classEventRouter.html#a793c81765420a1a46eb717ec28ece4e0">_ReceiveFlits</a>( );
<a name="l00164"></a>00164   <a class="code" href="classEventRouter.html#a993804933bde4a3dab72ad84c07cca39">_ReceiveCredits</a>( );
<a name="l00165"></a>00165 }
<a name="l00166"></a>00166 
<a name="l00167"></a><a class="code" href="classEventRouter.html#a4e1b6144e152d04f1b37574f082fc701">00167</a> <span class="keywordtype">void</span> <a class="code" href="classEventRouter.html#a4e1b6144e152d04f1b37574f082fc701">EventRouter::_InternalStep</a>( )
<a name="l00168"></a>00168 {
<a name="l00169"></a>00169   <span class="comment">// Receive incoming flits</span>
<a name="l00170"></a>00170   <a class="code" href="classEventRouter.html#ad37a94a5b75dfec4a7893a129f4406c2">_IncomingFlits</a>( );
<a name="l00171"></a>00171 
<a name="l00172"></a>00172   <span class="comment">// The input pipe simulates routing delay</span>
<a name="l00173"></a>00173   <a class="code" href="classEventRouter.html#a7e41defdf126e3cb7048c5fe65cb44ad">_arrival_pipe</a>-&gt;<a class="code" href="classPipelineFIFO.html#a1c55800a4577905349e6bcf5270f267b">Advance</a>( );
<a name="l00174"></a>00174 
<a name="l00175"></a>00175   <span class="comment">// Clear output requests</span>
<a name="l00176"></a>00176   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> <a class="code" href="cuobjdump__to__ptxplus_8cc.html#a850af8cfb632548b213ce5b365fedd1a">output</a> = 0; <a class="code" href="cuobjdump__to__ptxplus_8cc.html#a850af8cfb632548b213ce5b365fedd1a">output</a> &lt; _outputs; ++<a class="code" href="cuobjdump__to__ptxplus_8cc.html#a850af8cfb632548b213ce5b365fedd1a">output</a> ) {
<a name="l00177"></a>00177     <a class="code" href="classEventRouter.html#a1bd0765ee6fe56109897680137ebc863">_arrival_arbiter</a>[<a class="code" href="cuobjdump__to__ptxplus_8cc.html#a850af8cfb632548b213ce5b365fedd1a">output</a>]-&gt;<a class="code" href="classPriorityArbiter.html#ab9d202d9ae3ceed1e17f5d16d1220cc5">Clear</a>( );
<a name="l00178"></a>00178   }
<a name="l00179"></a>00179 
<a name="l00180"></a>00180   <span class="comment">// Check input arrival queues and generate</span>
<a name="l00181"></a>00181   <span class="comment">// requests for the outputs</span>
<a name="l00182"></a>00182   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> <a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a> = 0; <a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a> &lt; _inputs; ++<a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a> ) {
<a name="l00183"></a>00183     <a class="code" href="classEventRouter.html#aa458b756ed9673f61ae02cbfb8f8ab3c">_ArrivalRequests</a>( <a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a> );
<a name="l00184"></a>00184   }
<a name="l00185"></a>00185 
<a name="l00186"></a>00186   <span class="comment">// Arbitrate between requests at outputs</span>
<a name="l00187"></a>00187   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> <a class="code" href="cuobjdump__to__ptxplus_8cc.html#a850af8cfb632548b213ce5b365fedd1a">output</a> = 0; <a class="code" href="cuobjdump__to__ptxplus_8cc.html#a850af8cfb632548b213ce5b365fedd1a">output</a> &lt; _outputs; ++<a class="code" href="cuobjdump__to__ptxplus_8cc.html#a850af8cfb632548b213ce5b365fedd1a">output</a> ) {
<a name="l00188"></a>00188     <a class="code" href="classEventRouter.html#a3512ffbddf514969f95d672dec6e4e4f">_ArrivalArb</a>( <a class="code" href="cuobjdump__to__ptxplus_8cc.html#a850af8cfb632548b213ce5b365fedd1a">output</a> );
<a name="l00189"></a>00189   }
<a name="l00190"></a>00190 
<a name="l00191"></a>00191   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> <a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a> = 0; <a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a> &lt; _inputs; ++<a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a> ) {
<a name="l00192"></a>00192     <a class="code" href="classEventRouter.html#a6850a1bf75735c5e597b60219dc6806f">_transport_arbiter</a>[<a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a>]-&gt;<a class="code" href="classPriorityArbiter.html#ab9d202d9ae3ceed1e17f5d16d1220cc5">Clear</a>( );
<a name="l00193"></a>00193   }
<a name="l00194"></a>00194 
<a name="l00195"></a>00195   <a class="code" href="classEventRouter.html#a270ecba4d458fe1f31eddc001e5fe2b7">_crossbar_pipe</a>-&gt;<a class="code" href="classPipelineFIFO.html#a23f5feeb8b1a7abfd2b7a36e326b6568">WriteAll</a>( 0 );
<a name="l00196"></a>00196   <a class="code" href="classEventRouter.html#a1d6bb7dbab759a627ef735122becc9c2">_credit_pipe</a>-&gt;<a class="code" href="classPipelineFIFO.html#a23f5feeb8b1a7abfd2b7a36e326b6568">WriteAll</a>( 0 );
<a name="l00197"></a>00197 
<a name="l00198"></a>00198   <span class="comment">// Generate transport events and their</span>
<a name="l00199"></a>00199   <span class="comment">// requests for the inputs</span>
<a name="l00200"></a>00200   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> <a class="code" href="cuobjdump__to__ptxplus_8cc.html#a850af8cfb632548b213ce5b365fedd1a">output</a> = 0; <a class="code" href="cuobjdump__to__ptxplus_8cc.html#a850af8cfb632548b213ce5b365fedd1a">output</a> &lt; _outputs; ++<a class="code" href="cuobjdump__to__ptxplus_8cc.html#a850af8cfb632548b213ce5b365fedd1a">output</a> ) {
<a name="l00201"></a>00201     <a class="code" href="classEventRouter.html#a81f11252e3cb5b1c7d205d95bdb2178f">_TransportRequests</a>( <a class="code" href="cuobjdump__to__ptxplus_8cc.html#a850af8cfb632548b213ce5b365fedd1a">output</a> );
<a name="l00202"></a>00202   }
<a name="l00203"></a>00203 
<a name="l00204"></a>00204   <span class="comment">// Arbitrate between requests at inputs</span>
<a name="l00205"></a>00205   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> <a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a> = 0; <a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a> &lt; _inputs; ++<a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a> ) {
<a name="l00206"></a>00206     <a class="code" href="classEventRouter.html#ac0ce688b9ccd655bbbd9545b3859184f">_TransportArb</a>( <a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a> );
<a name="l00207"></a>00207   }
<a name="l00208"></a>00208 
<a name="l00209"></a>00209   <a class="code" href="classEventRouter.html#a270ecba4d458fe1f31eddc001e5fe2b7">_crossbar_pipe</a>-&gt;<a class="code" href="classPipelineFIFO.html#a1c55800a4577905349e6bcf5270f267b">Advance</a>( );
<a name="l00210"></a>00210   <a class="code" href="classEventRouter.html#a1d6bb7dbab759a627ef735122becc9c2">_credit_pipe</a>-&gt;<a class="code" href="classPipelineFIFO.html#a1c55800a4577905349e6bcf5270f267b">Advance</a>( );
<a name="l00211"></a>00211 
<a name="l00212"></a>00212   <a class="code" href="classEventRouter.html#ab7f28b9d248395419d915762271f370b">_OutputQueuing</a>( );
<a name="l00213"></a>00213 }
<a name="l00214"></a>00214 
<a name="l00215"></a>00215 <span class="keywordtype">void</span> <a class="code" href="classEventRouter.html#a61b7a8b8437565ca3c6246dfa58c68b0">EventRouter::WriteOutputs</a>( )
<a name="l00216"></a>00216 {
<a name="l00217"></a>00217   <a class="code" href="classEventRouter.html#a0514e46558ea5b05b302c0dd75421c08">_SendFlits</a>( );
<a name="l00218"></a>00218   <a class="code" href="classEventRouter.html#a886e76f6ace07c869ddf616e1e051585">_SendCredits</a>( );
<a name="l00219"></a>00219 }
<a name="l00220"></a>00220 
<a name="l00221"></a>00221 <span class="keywordtype">void</span> <a class="code" href="classEventRouter.html#a793c81765420a1a46eb717ec28ece4e0">EventRouter::_ReceiveFlits</a>( )
<a name="l00222"></a>00222 {
<a name="l00223"></a>00223   <a class="code" href="structFlit.html">Flit</a> *f;
<a name="l00224"></a>00224 
<a name="l00225"></a>00225   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> <a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a> = 0; <a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a> &lt; _inputs; ++<a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a> ) { 
<a name="l00226"></a>00226     f = <a class="code" href="classRouter.html#af9e13814363a908a6103e008a2a8e20c">_input_channels</a>[<a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a>]-&gt;Receive();
<a name="l00227"></a>00227 
<a name="l00228"></a>00228     <span class="keywordflow">if</span> ( f ) {
<a name="l00229"></a>00229       <a class="code" href="classEventRouter.html#a6a5ed2511c12196bedf0ff54d2b4990f">_input_buffer</a>[<a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a>].push( f );
<a name="l00230"></a>00230     }
<a name="l00231"></a>00231   }
<a name="l00232"></a>00232 }
<a name="l00233"></a>00233 
<a name="l00234"></a>00234 <span class="keywordtype">void</span> <a class="code" href="classEventRouter.html#a993804933bde4a3dab72ad84c07cca39">EventRouter::_ReceiveCredits</a>( )
<a name="l00235"></a>00235 {
<a name="l00236"></a>00236   <a class="code" href="classCredit.html">Credit</a> *c;
<a name="l00237"></a>00237 
<a name="l00238"></a>00238   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> <a class="code" href="cuobjdump__to__ptxplus_8cc.html#a850af8cfb632548b213ce5b365fedd1a">output</a> = 0; <a class="code" href="cuobjdump__to__ptxplus_8cc.html#a850af8cfb632548b213ce5b365fedd1a">output</a> &lt; _outputs; ++<a class="code" href="cuobjdump__to__ptxplus_8cc.html#a850af8cfb632548b213ce5b365fedd1a">output</a> ) {  
<a name="l00239"></a>00239     c = <a class="code" href="classRouter.html#a05cc9990a9c5ab3976d5bec419170686">_output_credits</a>[<a class="code" href="cuobjdump__to__ptxplus_8cc.html#a850af8cfb632548b213ce5b365fedd1a">output</a>]-&gt;Receive();
<a name="l00240"></a>00240 
<a name="l00241"></a>00241     <span class="keywordflow">if</span> ( c ) {
<a name="l00242"></a>00242       <a class="code" href="classEventRouter.html#a0276d1b5a43f814fa24f4d10d9c9e6b0">_out_cred_buffer</a>[<a class="code" href="cuobjdump__to__ptxplus_8cc.html#a850af8cfb632548b213ce5b365fedd1a">output</a>].push( c );
<a name="l00243"></a>00243     }
<a name="l00244"></a>00244   }
<a name="l00245"></a>00245 }
<a name="l00246"></a>00246 
<a name="l00247"></a>00247 <span class="keywordtype">void</span> <a class="code" href="classEventRouter.html#a499f4a324fe390957c27ca8a7e7a1818">EventRouter::_ProcessWaiting</a>( <span class="keywordtype">int</span> <a class="code" href="cuobjdump__to__ptxplus_8cc.html#a850af8cfb632548b213ce5b365fedd1a">output</a>, <span class="keywordtype">int</span> out_vc )
<a name="l00248"></a>00248 {
<a name="l00249"></a>00249   <span class="comment">// out_vc just sent the transport event for out_vc, </span>
<a name="l00250"></a>00250   <span class="comment">// check if any events are queued on that vc.  if so,</span>
<a name="l00251"></a>00251   <span class="comment">// generate another transport event and set the </span>
<a name="l00252"></a>00252   <span class="comment">// owner of the vc, otherwise set the vc to idle.</span>
<a name="l00253"></a>00253 
<a name="l00254"></a>00254   <span class="keywordtype">int</span> credits;
<a name="l00255"></a>00255   
<a name="l00256"></a>00256   tTransportEvent *tevt;
<a name="l00257"></a>00257 
<a name="l00258"></a>00258   <a class="code" href="structEventNextVCState_1_1tWaiting.html">EventNextVCState::tWaiting</a> *w;
<a name="l00259"></a>00259 
<a name="l00260"></a>00260   <span class="keywordflow">if</span> ( <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;IsWaiting( out_vc ) ) {
<a name="l00261"></a>00261         
<a name="l00262"></a>00262     <span class="comment">// State remains as busy, but the waiting VC takes over</span>
<a name="l00263"></a>00263     w = <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#aecaaf0c763aefa9e77e318a8622e97ce">PopWaiting</a>( out_vc );
<a name="l00264"></a>00264     
<a name="l00265"></a>00265     <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#a7d99ddd073957763deb9bbe9faa9e2b0">SetState</a>( out_vc, <a class="code" href="classEventNextVCState.html#a2ab8c3a3d963c2317cf00080d6c6be6aa9dde2512d7f1bf17de03229200e8b7c7">EventNextVCState::busy</a> );
<a name="l00266"></a>00266     <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#a0ac06a38d090b1214fb59085a13437ca">SetInput</a>( out_vc, w-&gt;<a class="code" href="structEventNextVCState_1_1tWaiting.html#a61868145a914514d4452779359c2862b">input</a> );
<a name="l00267"></a>00267     <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#afa9f279d889de002aa2b9cf8064e1c35">SetInputVC</a>( out_vc, w-&gt;<a class="code" href="structEventNextVCState_1_1tWaiting.html#ae7dbb6e1f8fb7d76309cc66a7da22359">vc</a> );
<a name="l00268"></a>00268 
<a name="l00269"></a>00269     <span class="keywordflow">if</span> ( w-&gt;<a class="code" href="structEventNextVCState_1_1tWaiting.html#ad92a357434764b4f66b4568c1c5d4885">watch</a> ) {
<a name="l00270"></a>00270       cout &lt;&lt; <span class="stringliteral">&quot;Dequeuing waiting arrival event at &quot;</span> &lt;&lt; <a class="code" href="classModule.html#a0eeaa2b9a7d2ba88ab05682444898b08">FullName</a>() 
<a name="l00271"></a>00271        &lt;&lt; <span class="stringliteral">&quot; for flit &quot;</span> &lt;&lt; w-&gt;<a class="code" href="structEventNextVCState_1_1tWaiting.html#a68dd63b3d7f1265fe3d65c3ae6e874c6">id</a> &lt;&lt; endl;
<a name="l00272"></a>00272     }
<a name="l00273"></a>00273     
<a name="l00274"></a>00274     credits = <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#a4a0966188ee4acf4127424351d7f07de">GetCredits</a>( out_vc );
<a name="l00275"></a>00275 
<a name="l00276"></a>00276     <span class="comment">// Try to queue a transmit event for a waiting packet</span>
<a name="l00277"></a>00277     <span class="keywordflow">if</span> ( credits &gt; 0 ) {
<a name="l00278"></a>00278       tevt         = <span class="keyword">new</span> tTransportEvent;
<a name="l00279"></a>00279       tevt-&gt;src_vc = w-&gt;<a class="code" href="structEventNextVCState_1_1tWaiting.html#ae7dbb6e1f8fb7d76309cc66a7da22359">vc</a>;
<a name="l00280"></a>00280       tevt-&gt;dst_vc = out_vc;
<a name="l00281"></a>00281       tevt-&gt;input  = w-&gt;<a class="code" href="structEventNextVCState_1_1tWaiting.html#a61868145a914514d4452779359c2862b">input</a>;
<a name="l00282"></a>00282       tevt-&gt;watch  = w-&gt;<a class="code" href="structEventNextVCState_1_1tWaiting.html#ad92a357434764b4f66b4568c1c5d4885">watch</a>; <span class="comment">// just to have something here</span>
<a name="l00283"></a>00283       tevt-&gt;id     = w-&gt;<a class="code" href="structEventNextVCState_1_1tWaiting.html#a68dd63b3d7f1265fe3d65c3ae6e874c6">id</a>;
<a name="l00284"></a>00284       
<a name="l00285"></a>00285       <a class="code" href="classEventRouter.html#a07aed10ad1ef0dca3fe63dc4281a7584">_transport_queue</a>[output].push( tevt );
<a name="l00286"></a>00286       
<a name="l00287"></a>00287       <span class="keywordflow">if</span> ( tevt-&gt;watch ) {
<a name="l00288"></a>00288     cout &lt;&lt; <span class="stringliteral">&quot;Injecting transport event at &quot;</span> &lt;&lt; <a class="code" href="classModule.html#a0eeaa2b9a7d2ba88ab05682444898b08">FullName</a>() 
<a name="l00289"></a>00289          &lt;&lt; <span class="stringliteral">&quot; for flit &quot;</span> &lt;&lt; tevt-&gt;id &lt;&lt; endl;
<a name="l00290"></a>00290       }
<a name="l00291"></a>00291       
<a name="l00292"></a>00292       credits--;
<a name="l00293"></a>00293       <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#a5bb6ddfb217018585c31ddfa2c281914">SetCredits</a>( out_vc, credits );
<a name="l00294"></a>00294       <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#aac2de39272d6f99e976c0e5a09146442">SetPresence</a>( out_vc, w-&gt;<a class="code" href="structEventNextVCState_1_1tWaiting.html#accadafd5853b304641acd8502f258626">pres</a> - 1 );
<a name="l00295"></a>00295       
<a name="l00296"></a>00296     } <span class="keywordflow">else</span> {
<a name="l00297"></a>00297       <span class="comment">// No credits available, just store presence</span>
<a name="l00298"></a>00298       <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#aac2de39272d6f99e976c0e5a09146442">SetPresence</a>( out_vc, w-&gt;<a class="code" href="structEventNextVCState_1_1tWaiting.html#accadafd5853b304641acd8502f258626">pres</a> );
<a name="l00299"></a>00299     }
<a name="l00300"></a>00300 
<a name="l00301"></a>00301     <span class="keyword">delete</span> w;
<a name="l00302"></a>00302 
<a name="l00303"></a>00303   } <span class="keywordflow">else</span> {
<a name="l00304"></a>00304     <span class="comment">// Tail sent, none waiting =&gt; VC is idle</span>
<a name="l00305"></a>00305     <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#a7d99ddd073957763deb9bbe9faa9e2b0">SetState</a>( out_vc, <a class="code" href="classEventNextVCState.html#a2ab8c3a3d963c2317cf00080d6c6be6aa729d93bbfb674e10eb6a4d355bc5d1d2">EventNextVCState::idle</a> );
<a name="l00306"></a>00306   }
<a name="l00307"></a>00307 }
<a name="l00308"></a>00308 
<a name="l00309"></a>00309 <span class="keywordtype">void</span> <a class="code" href="classEventRouter.html#ad37a94a5b75dfec4a7893a129f4406c2">EventRouter::_IncomingFlits</a>( )
<a name="l00310"></a>00310 {
<a name="l00311"></a>00311   <a class="code" href="structFlit.html">Flit</a>   *f;
<a name="l00312"></a>00312   <a class="code" href="classBuffer.html">Buffer</a> *cur_buf;
<a name="l00313"></a>00313 
<a name="l00314"></a>00314   tArrivalEvent *aevt;
<a name="l00315"></a>00315 
<a name="l00316"></a>00316   <a class="code" href="classEventRouter.html#a7e41defdf126e3cb7048c5fe65cb44ad">_arrival_pipe</a>-&gt;<a class="code" href="classPipelineFIFO.html#a23f5feeb8b1a7abfd2b7a36e326b6568">WriteAll</a>( 0 );
<a name="l00317"></a>00317 
<a name="l00318"></a>00318   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> <a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a> = 0; <a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a> &lt; _inputs; ++<a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a> ) {
<a name="l00319"></a>00319     <span class="keywordflow">if</span> ( !<a class="code" href="classEventRouter.html#a6a5ed2511c12196bedf0ff54d2b4990f">_input_buffer</a>[<a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a>].empty( ) ) {
<a name="l00320"></a>00320       f = <a class="code" href="classEventRouter.html#a6a5ed2511c12196bedf0ff54d2b4990f">_input_buffer</a>[<a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a>].front( );
<a name="l00321"></a>00321       <a class="code" href="classEventRouter.html#a6a5ed2511c12196bedf0ff54d2b4990f">_input_buffer</a>[<a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a>].pop( );
<a name="l00322"></a>00322 
<a name="l00323"></a>00323       cur_buf = <a class="code" href="classEventRouter.html#a9b9e0996ceb70b9677e66b77f8555ba7">_buf</a>[<a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a>];
<a name="l00324"></a>00324       <span class="keywordtype">int</span> vc = f-&gt;<a class="code" href="structFlit.html#a91f87fc20463a5fe6ea5e9e035991701">vc</a>;
<a name="l00325"></a>00325 
<a name="l00326"></a>00326       cur_buf-&gt;<a class="code" href="classBuffer.html#a193b14a90bab6ffa60d1c15bee587878">AddFlit</a>( vc, f );
<a name="l00327"></a>00327 
<a name="l00328"></a>00328       <span class="comment">// Head flit arriving at idle VC</span>
<a name="l00329"></a>00329       <span class="keywordflow">if</span> ( !<a class="code" href="classEventRouter.html#aaa3e7b4d6314f8a0133cdf67c6afe62b">_active</a>[<a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a>][vc] ) {
<a name="l00330"></a>00330     
<a name="l00331"></a>00331     <span class="keywordflow">if</span> ( !f-&gt;<a class="code" href="structFlit.html#a784a6bcb041646c2b8c068b7de4bdc9a">head</a> ) {
<a name="l00332"></a>00332       cout &lt;&lt; <span class="stringliteral">&quot;Non-head flit:&quot;</span> &lt;&lt; endl;
<a name="l00333"></a>00333       cout &lt;&lt; *f;
<a name="l00334"></a>00334       <a class="code" href="classModule.html#acfa9d0dc518853045e0d2356d138717f">Error</a>( <span class="stringliteral">&quot;Received non-head flit at idle VC&quot;</span> );
<a name="l00335"></a>00335     }
<a name="l00336"></a>00336 
<a name="l00337"></a>00337     <span class="keyword">const</span> <a class="code" href="classOutputSet.html">OutputSet</a> *route_set;
<a name="l00338"></a>00338     <span class="keywordtype">int</span> out_vc, out_port;
<a name="l00339"></a>00339 
<a name="l00340"></a>00340     cur_buf-&gt;<a class="code" href="classBuffer.html#a563868c3387393d9356aa2595b4a1089">Route</a>( vc, <a class="code" href="classEventRouter.html#a52a0b1f1f3b4983ad935ea3217eb79c1">_rf</a>, <span class="keyword">this</span>, f, <a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a> );
<a name="l00341"></a>00341     route_set = cur_buf-&gt;<a class="code" href="classBuffer.html#a929689baafed9b0892c52128fc5946de">GetRouteSet</a>( vc );
<a name="l00342"></a>00342 
<a name="l00343"></a>00343     <span class="keywordflow">if</span> ( !route_set-&gt;<a class="code" href="classOutputSet.html#a8303659524283c5e3012e0d8b48d062b">GetPortVC</a>( &amp;out_port, &amp;out_vc ) ) {
<a name="l00344"></a>00344       <a class="code" href="classModule.html#acfa9d0dc518853045e0d2356d138717f">Error</a>( <span class="stringliteral">&quot;The event-driven router requires routing functions with a single (port,vc) output&quot;</span> );
<a name="l00345"></a>00345     }
<a name="l00346"></a>00346 
<a name="l00347"></a>00347     cur_buf-&gt;<a class="code" href="classBuffer.html#a500fe8380d4ae85f86d0aa06c6523ded">SetOutput</a>( vc, out_port, out_vc );
<a name="l00348"></a>00348     <a class="code" href="classEventRouter.html#aaa3e7b4d6314f8a0133cdf67c6afe62b">_active</a>[<a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a>][vc] = <span class="keyword">true</span>;
<a name="l00349"></a>00349       } <span class="keywordflow">else</span> {
<a name="l00350"></a>00350     <span class="keywordflow">if</span> ( f-&gt;<a class="code" href="structFlit.html#a784a6bcb041646c2b8c068b7de4bdc9a">head</a> ) {
<a name="l00351"></a>00351       cout &lt;&lt; *f;
<a name="l00352"></a>00352       <a class="code" href="classModule.html#acfa9d0dc518853045e0d2356d138717f">Error</a>( <span class="stringliteral">&quot;Received head flit at non-idle VC.&quot;</span> );
<a name="l00353"></a>00353     }
<a name="l00354"></a>00354       }
<a name="l00355"></a>00355       
<a name="l00356"></a>00356       <span class="keywordflow">if</span> ( f-&gt;<a class="code" href="structFlit.html#aa5328bdf6d139ea1c8e503228bf8aae5">watch</a> ) {
<a name="l00357"></a>00357     *<a class="code" href="globals_8hpp.html#a54233075d19c60edbe29257351f7fe3d">gWatchOut</a> &lt;&lt; <a class="code" href="globals_8hpp.html#ad223077827fd15227dc1bd007980a296">GetSimTime</a>() &lt;&lt; <span class="stringliteral">&quot; | &quot;</span> &lt;&lt; <a class="code" href="classModule.html#a0eeaa2b9a7d2ba88ab05682444898b08">FullName</a>() &lt;&lt; <span class="stringliteral">&quot; | &quot;</span>
<a name="l00358"></a>00358             &lt;&lt; <span class="stringliteral">&quot;Received flit at &quot;</span> &lt;&lt; <a class="code" href="classModule.html#a0eeaa2b9a7d2ba88ab05682444898b08">FullName</a>() &lt;&lt; <span class="stringliteral">&quot;.  Output port = &quot;</span> 
<a name="l00359"></a>00359             &lt;&lt; cur_buf-&gt;<a class="code" href="classBuffer.html#ae3e4fc931c5fe841f454afdc29d43cf0">GetOutputPort</a>( vc ) &lt;&lt; <span class="stringliteral">&quot;, output VC = &quot;</span> 
<a name="l00360"></a>00360             &lt;&lt; cur_buf-&gt;<a class="code" href="classBuffer.html#ade55f96ac295b9eeeff4b0dca2218396">GetOutputVC</a>( vc ) &lt;&lt; endl
<a name="l00361"></a>00361             &lt;&lt; *f;
<a name="l00362"></a>00362       }
<a name="l00363"></a>00363 
<a name="l00364"></a>00364       <span class="comment">// In cut-through mode, only head flits generate arrivals,</span>
<a name="l00365"></a>00365       <span class="comment">// otherwise all flits generate</span>
<a name="l00366"></a>00366 
<a name="l00367"></a>00367       <span class="keywordflow">if</span> ( ( !<a class="code" href="classEventRouter.html#a4989d0bf33c1b8d1f1acb26af603b952">_vct</a> ) || ( <a class="code" href="classEventRouter.html#a4989d0bf33c1b8d1f1acb26af603b952">_vct</a> &amp;&amp; f-&gt;<a class="code" href="structFlit.html#a784a6bcb041646c2b8c068b7de4bdc9a">head</a> ) ) {
<a name="l00368"></a>00368     <span class="comment">// Add the arrival event to a delay pipeline to</span>
<a name="l00369"></a>00369     <span class="comment">// account for routing/decoding time</span>
<a name="l00370"></a>00370 
<a name="l00371"></a>00371     aevt         = <span class="keyword">new</span> tArrivalEvent;
<a name="l00372"></a>00372     
<a name="l00373"></a>00373     aevt-&gt;input  = <a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a>;
<a name="l00374"></a>00374     aevt-&gt;output = cur_buf-&gt;<a class="code" href="classBuffer.html#ae3e4fc931c5fe841f454afdc29d43cf0">GetOutputPort</a>( vc );
<a name="l00375"></a>00375     aevt-&gt;src_vc = f-&gt;<a class="code" href="structFlit.html#a91f87fc20463a5fe6ea5e9e035991701">vc</a>;
<a name="l00376"></a>00376     aevt-&gt;dst_vc = cur_buf-&gt;<a class="code" href="classBuffer.html#ade55f96ac295b9eeeff4b0dca2218396">GetOutputVC</a>( vc );
<a name="l00377"></a>00377     aevt-&gt;head   = f-&gt;<a class="code" href="structFlit.html#a784a6bcb041646c2b8c068b7de4bdc9a">head</a>;
<a name="l00378"></a>00378     aevt-&gt;tail   = f-&gt;<a class="code" href="structFlit.html#aa0f32295d57acd313ddf257127b5c850">tail</a>;
<a name="l00379"></a>00379     
<a name="l00380"></a>00380     <span class="comment">//if ( f-&gt;head &amp;&amp; f-&gt;tail ) {</span>
<a name="l00381"></a>00381     <span class="comment">//  Error( &quot;Head/tail packets not supported.&quot; );</span>
<a name="l00382"></a>00382     <span class="comment">//}</span>
<a name="l00383"></a>00383     
<a name="l00384"></a>00384     aevt-&gt;watch  = f-&gt;<a class="code" href="structFlit.html#aa5328bdf6d139ea1c8e503228bf8aae5">watch</a>;
<a name="l00385"></a>00385     aevt-&gt;id     = f-&gt;<a class="code" href="structFlit.html#aeae7d176eaa77ba7300abee6afbee8a4">id</a>;
<a name="l00386"></a>00386     
<a name="l00387"></a>00387     <a class="code" href="classEventRouter.html#a7e41defdf126e3cb7048c5fe65cb44ad">_arrival_pipe</a>-&gt;<a class="code" href="classPipelineFIFO.html#ae3c4fe8b1acbae49dc5cc8b8960fb219">Write</a>( aevt, <a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a> );
<a name="l00388"></a>00388 
<a name="l00389"></a>00389     <span class="keywordflow">if</span> ( aevt-&gt;watch ) {
<a name="l00390"></a>00390       cout &lt;&lt; <span class="stringliteral">&quot;Injected arrival event at &quot;</span> &lt;&lt; <a class="code" href="classModule.html#a0eeaa2b9a7d2ba88ab05682444898b08">FullName</a>() 
<a name="l00391"></a>00391            &lt;&lt; <span class="stringliteral">&quot; for flit &quot;</span> &lt;&lt; aevt-&gt;id &lt;&lt; endl;
<a name="l00392"></a>00392     }
<a name="l00393"></a>00393       }
<a name="l00394"></a>00394     }
<a name="l00395"></a>00395   }
<a name="l00396"></a>00396 }
<a name="l00397"></a>00397 
<a name="l00398"></a>00398 <span class="keywordtype">void</span> <a class="code" href="classEventRouter.html#aa458b756ed9673f61ae02cbfb8f8ab3c">EventRouter::_ArrivalRequests</a>( <span class="keywordtype">int</span> <a class="code" href="lex_8yy_8c.html#a171692544b8e065853e387755849a433">input</a> ) 
<a name="l00399"></a>00399 {
<a name="l00400"></a>00400   tArrivalEvent *aevt;
<a name="l00401"></a>00401   
<a name="l00402"></a>00402   aevt = <a class="code" href="classEventRouter.html#a7e41defdf126e3cb7048c5fe65cb44ad">_arrival_pipe</a>-&gt;<a class="code" href="classPipelineFIFO.html#a31ae4ef08ee582e33c05789230d1a3b7">Read</a>( input );
<a name="l00403"></a>00403   <span class="keywordflow">if</span> ( aevt ) {
<a name="l00404"></a>00404     <a class="code" href="classEventRouter.html#a02745303a3ac7c276cfdf4095202f61d">_arrival_queue</a>[input].push( aevt );
<a name="l00405"></a>00405   }
<a name="l00406"></a>00406   
<a name="l00407"></a>00407   <span class="keywordflow">if</span> ( !<a class="code" href="classEventRouter.html#a02745303a3ac7c276cfdf4095202f61d">_arrival_queue</a>[input].empty( ) ) {
<a name="l00408"></a>00408     aevt = <a class="code" href="classEventRouter.html#a02745303a3ac7c276cfdf4095202f61d">_arrival_queue</a>[input].front( );
<a name="l00409"></a>00409     <a class="code" href="classEventRouter.html#a1bd0765ee6fe56109897680137ebc863">_arrival_arbiter</a>[aevt-&gt;output]-&gt;<a class="code" href="classPriorityArbiter.html#a5b9ccfee25aec38cfdcc52a8399c7877">AddRequest</a>( input );
<a name="l00410"></a>00410   }
<a name="l00411"></a>00411 }
<a name="l00412"></a>00412 
<a name="l00413"></a>00413 <span class="keywordtype">void</span> <a class="code" href="classEventRouter.html#a0174050aacf4226530757e33e33d1f70">EventRouter::_SendTransport</a>( <span class="keywordtype">int</span> input, <span class="keywordtype">int</span> output, tArrivalEvent *aevt )
<a name="l00414"></a>00414 {
<a name="l00415"></a>00415   <span class="comment">// Try to send a transport event</span>
<a name="l00416"></a>00416 
<a name="l00417"></a>00417   tTransportEvent *tevt;
<a name="l00418"></a>00418 
<a name="l00419"></a>00419   <span class="keywordtype">int</span> credits;
<a name="l00420"></a>00420   <span class="keywordtype">int</span> pres;
<a name="l00421"></a>00421 
<a name="l00422"></a>00422   credits = <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#a4a0966188ee4acf4127424351d7f07de">GetCredits</a>( aevt-&gt;dst_vc );
<a name="l00423"></a>00423   
<a name="l00424"></a>00424   <span class="keywordflow">if</span> ( credits &gt; 0 ) {
<a name="l00425"></a>00425     <span class="comment">// Take a credit and queue a transport event</span>
<a name="l00426"></a>00426     credits--;
<a name="l00427"></a>00427     <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#a5bb6ddfb217018585c31ddfa2c281914">SetCredits</a>( aevt-&gt;dst_vc, credits );
<a name="l00428"></a>00428     
<a name="l00429"></a>00429     tevt         = <span class="keyword">new</span> tTransportEvent;
<a name="l00430"></a>00430     tevt-&gt;src_vc = aevt-&gt;src_vc;
<a name="l00431"></a>00431     tevt-&gt;dst_vc = aevt-&gt;dst_vc;
<a name="l00432"></a>00432     tevt-&gt;input  = input;
<a name="l00433"></a>00433     tevt-&gt;watch  = aevt-&gt;watch;
<a name="l00434"></a>00434     tevt-&gt;id     = aevt-&gt;id;
<a name="l00435"></a>00435     
<a name="l00436"></a>00436     <a class="code" href="classEventRouter.html#a07aed10ad1ef0dca3fe63dc4281a7584">_transport_queue</a>[output].push( tevt );
<a name="l00437"></a>00437     
<a name="l00438"></a>00438     <span class="keywordflow">if</span> ( tevt-&gt;watch ) {
<a name="l00439"></a>00439       cout &lt;&lt; <span class="stringliteral">&quot;Injecting transport event at &quot;</span> &lt;&lt; <a class="code" href="classModule.html#a0eeaa2b9a7d2ba88ab05682444898b08">FullName</a>() 
<a name="l00440"></a>00440        &lt;&lt; <span class="stringliteral">&quot; for flit &quot;</span> &lt;&lt; tevt-&gt;id &lt;&lt; endl;
<a name="l00441"></a>00441     }
<a name="l00442"></a>00442   } <span class="keywordflow">else</span> {
<a name="l00443"></a>00443     <span class="keywordflow">if</span> ( aevt-&gt;watch ) {
<a name="l00444"></a>00444       cout &lt;&lt; <span class="stringliteral">&quot;No credits available at &quot;</span> &lt;&lt; <a class="code" href="classModule.html#a0eeaa2b9a7d2ba88ab05682444898b08">FullName</a>() 
<a name="l00445"></a>00445        &lt;&lt; <span class="stringliteral">&quot; for flit &quot;</span> &lt;&lt; aevt-&gt;id &lt;&lt; <span class="stringliteral">&quot; storing presence.&quot;</span> &lt;&lt; endl;
<a name="l00446"></a>00446     }
<a name="l00447"></a>00447     
<a name="l00448"></a>00448     <span class="comment">// No credits available, just store presence</span>
<a name="l00449"></a>00449     pres = <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#a5278f920c3170fcf039693b545293d22">GetPresence</a>( aevt-&gt;dst_vc );
<a name="l00450"></a>00450     <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#aac2de39272d6f99e976c0e5a09146442">SetPresence</a>( aevt-&gt;dst_vc, pres + 1 );
<a name="l00451"></a>00451   }
<a name="l00452"></a>00452 }
<a name="l00453"></a>00453 
<a name="l00454"></a>00454 <span class="keywordtype">void</span> <a class="code" href="classEventRouter.html#a3512ffbddf514969f95d672dec6e4e4f">EventRouter::_ArrivalArb</a>( <span class="keywordtype">int</span> output )
<a name="l00455"></a>00455 {
<a name="l00456"></a>00456   tArrivalEvent   *aevt;
<a name="l00457"></a>00457   tTransportEvent *tevt;
<a name="l00458"></a>00458   <a class="code" href="classCredit.html">Credit</a>          *c;
<a name="l00459"></a>00459 
<a name="l00460"></a>00460   <a class="code" href="structEventNextVCState_1_1tWaiting.html">EventNextVCState::tWaiting</a> *w;
<a name="l00461"></a>00461 
<a name="l00462"></a>00462   <span class="keywordtype">int</span> input;
<a name="l00463"></a>00463   <span class="keywordtype">int</span> credits;
<a name="l00464"></a>00464   <span class="keywordtype">int</span> pres;
<a name="l00465"></a>00465 
<a name="l00466"></a>00466   <span class="comment">// Incoming credits can produce or enable</span>
<a name="l00467"></a>00467   <span class="comment">// transport events --- process them first</span>
<a name="l00468"></a>00468 
<a name="l00469"></a>00469   <span class="keywordflow">if</span> ( !<a class="code" href="classEventRouter.html#a0276d1b5a43f814fa24f4d10d9c9e6b0">_out_cred_buffer</a>[output].empty( ) ) {
<a name="l00470"></a>00470     c = <a class="code" href="classEventRouter.html#a0276d1b5a43f814fa24f4d10d9c9e6b0">_out_cred_buffer</a>[output].front( );
<a name="l00471"></a>00471     <a class="code" href="classEventRouter.html#a0276d1b5a43f814fa24f4d10d9c9e6b0">_out_cred_buffer</a>[output].pop( );
<a name="l00472"></a>00472     
<a name="l00473"></a>00473     assert( c-&gt;<a class="code" href="classCredit.html#af7898eb802885a65e5270096e0595abe">vc</a>.size() == 1 );
<a name="l00474"></a>00474     <span class="keywordtype">int</span> vc = *c-&gt;<a class="code" href="classCredit.html#af7898eb802885a65e5270096e0595abe">vc</a>.begin();
<a name="l00475"></a>00475 
<a name="l00476"></a>00476     <a class="code" href="classEventNextVCState.html#a2ab8c3a3d963c2317cf00080d6c6be6a">EventNextVCState::eNextVCState</a> state = 
<a name="l00477"></a>00477       <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#ae7dac61505d2673c240f979e29dbe608">GetState</a>( vc );
<a name="l00478"></a>00478     
<a name="l00479"></a>00479     credits = <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#a4a0966188ee4acf4127424351d7f07de">GetCredits</a>( vc );
<a name="l00480"></a>00480     pres    = <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#a5278f920c3170fcf039693b545293d22">GetPresence</a>( vc );
<a name="l00481"></a>00481       
<a name="l00482"></a>00482     <span class="keywordflow">if</span> ( <a class="code" href="classEventRouter.html#a4989d0bf33c1b8d1f1acb26af603b952">_vct</a> ) {
<a name="l00483"></a>00483       <span class="comment">// In cut-through mode, only head credits indicate a change in </span>
<a name="l00484"></a>00484       <span class="comment">// channel state.</span>
<a name="l00485"></a>00485 
<a name="l00486"></a>00486       <span class="keywordflow">if</span> ( c-&gt;<a class="code" href="classCredit.html#aba0c2a6d3e13c2c8cf9cc3bc1b9a91e2">head</a> ) {
<a name="l00487"></a>00487     credits++;
<a name="l00488"></a>00488     <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#a5bb6ddfb217018585c31ddfa2c281914">SetCredits</a>( vc, credits );
<a name="l00489"></a>00489     <a class="code" href="classEventRouter.html#a499f4a324fe390957c27ca8a7e7a1818">_ProcessWaiting</a>( output, vc );
<a name="l00490"></a>00490       }
<a name="l00491"></a>00491     } <span class="keywordflow">else</span> {
<a name="l00492"></a>00492       credits++;
<a name="l00493"></a>00493       <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#a5bb6ddfb217018585c31ddfa2c281914">SetCredits</a>( vc, credits );
<a name="l00494"></a>00494 
<a name="l00495"></a>00495       <span class="keywordflow">if</span> ( c-&gt;<a class="code" href="classCredit.html#a003d50d1b8d6cc6283a1099263add1fb">tail</a> ) { <span class="comment">// tail flit -- recycle VC</span>
<a name="l00496"></a>00496     <span class="keywordflow">if</span> ( state != <a class="code" href="classEventNextVCState.html#a2ab8c3a3d963c2317cf00080d6c6be6aa9dde2512d7f1bf17de03229200e8b7c7">EventNextVCState::busy</a> ) {
<a name="l00497"></a>00497       <a class="code" href="classModule.html#acfa9d0dc518853045e0d2356d138717f">Error</a>( <span class="stringliteral">&quot;Received tail credit at non-busy output VC&quot;</span> );
<a name="l00498"></a>00498     }
<a name="l00499"></a>00499     
<a name="l00500"></a>00500     <a class="code" href="classEventRouter.html#a499f4a324fe390957c27ca8a7e7a1818">_ProcessWaiting</a>( output, vc );
<a name="l00501"></a>00501       } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( ( state == <a class="code" href="classEventNextVCState.html#a2ab8c3a3d963c2317cf00080d6c6be6aa9dde2512d7f1bf17de03229200e8b7c7">EventNextVCState::busy</a> ) &amp;&amp; ( pres &gt; 0 ) ) {
<a name="l00502"></a>00502     <span class="comment">// Flit is present =&gt; generate transport event</span>
<a name="l00503"></a>00503     
<a name="l00504"></a>00504     tevt         = <span class="keyword">new</span> tTransportEvent;
<a name="l00505"></a>00505     tevt-&gt;input  = <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#a798aad21ee1a5e7a4d9a6b4658dabaff">GetInput</a>( vc );
<a name="l00506"></a>00506     tevt-&gt;src_vc = <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#a023c7e9dc2ab84ea22aad16139444c4a">GetInputVC</a>( vc );
<a name="l00507"></a>00507     tevt-&gt;dst_vc = vc;
<a name="l00508"></a>00508     tevt-&gt;watch  = <span class="keyword">false</span>;
<a name="l00509"></a>00509     tevt-&gt;id     = -1;
<a name="l00510"></a>00510     
<a name="l00511"></a>00511     <a class="code" href="classEventRouter.html#a07aed10ad1ef0dca3fe63dc4281a7584">_transport_queue</a>[output].push( tevt );
<a name="l00512"></a>00512     
<a name="l00513"></a>00513     pres--;
<a name="l00514"></a>00514     credits--;
<a name="l00515"></a>00515     <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#aac2de39272d6f99e976c0e5a09146442">SetPresence</a>( vc, pres );
<a name="l00516"></a>00516     <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#a5bb6ddfb217018585c31ddfa2c281914">SetCredits</a>( vc, credits );
<a name="l00517"></a>00517       }
<a name="l00518"></a>00518     }
<a name="l00519"></a>00519 
<a name="l00520"></a>00520     c-&gt;<a class="code" href="classCredit.html#a59c66f81e134f42283da1690dc41bfea">Free</a>();
<a name="l00521"></a>00521   }
<a name="l00522"></a>00522 
<a name="l00523"></a>00523   <span class="comment">// Now process arrival events</span>
<a name="l00524"></a>00524 
<a name="l00525"></a>00525   <a class="code" href="classEventRouter.html#a1bd0765ee6fe56109897680137ebc863">_arrival_arbiter</a>[output]-&gt;<a class="code" href="classPriorityArbiter.html#add8ae10301b47745fabc137e21ddc2de">Arbitrate</a>( );
<a name="l00526"></a>00526   input = <a class="code" href="classEventRouter.html#a1bd0765ee6fe56109897680137ebc863">_arrival_arbiter</a>[output]-&gt;<a class="code" href="classPriorityArbiter.html#a2c2099f5e28b9ab63f2f194f2ad166dd">Match</a>( );
<a name="l00527"></a>00527 
<a name="l00528"></a>00528   <span class="keywordflow">if</span> ( input != -1 ) {  
<a name="l00529"></a>00529     <span class="comment">// Winning arrival event gets access to output</span>
<a name="l00530"></a>00530 
<a name="l00531"></a>00531     aevt = <a class="code" href="classEventRouter.html#a02745303a3ac7c276cfdf4095202f61d">_arrival_queue</a>[input].front( );
<a name="l00532"></a>00532     <a class="code" href="classEventRouter.html#a02745303a3ac7c276cfdf4095202f61d">_arrival_queue</a>[input].pop( );
<a name="l00533"></a>00533 
<a name="l00534"></a>00534     <span class="keywordflow">if</span> ( aevt-&gt;watch ) {
<a name="l00535"></a>00535       cout &lt;&lt; <span class="stringliteral">&quot;Processing arrival event at &quot;</span> &lt;&lt; <a class="code" href="classModule.html#a0eeaa2b9a7d2ba88ab05682444898b08">FullName</a>() 
<a name="l00536"></a>00536          &lt;&lt; <span class="stringliteral">&quot; for flit &quot;</span> &lt;&lt; aevt-&gt;id &lt;&lt; endl;
<a name="l00537"></a>00537     }
<a name="l00538"></a>00538       
<a name="l00539"></a>00539     <a class="code" href="classEventNextVCState.html#a2ab8c3a3d963c2317cf00080d6c6be6a">EventNextVCState::eNextVCState</a> state = 
<a name="l00540"></a>00540       <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#ae7dac61505d2673c240f979e29dbe608">GetState</a>( aevt-&gt;dst_vc );
<a name="l00541"></a>00541 
<a name="l00542"></a>00542     <span class="keywordflow">if</span> ( aevt-&gt;head ) { <span class="comment">// Head flits</span>
<a name="l00543"></a>00543       <span class="keywordflow">if</span> ( state == <a class="code" href="classEventNextVCState.html#a2ab8c3a3d963c2317cf00080d6c6be6aa729d93bbfb674e10eb6a4d355bc5d1d2">EventNextVCState::idle</a> ) {
<a name="l00544"></a>00544     <span class="comment">// Allocate the output VC and queue a transport event</span>
<a name="l00545"></a>00545     <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#a7d99ddd073957763deb9bbe9faa9e2b0">SetState</a>( aevt-&gt;dst_vc, <a class="code" href="classEventNextVCState.html#a2ab8c3a3d963c2317cf00080d6c6be6aa9dde2512d7f1bf17de03229200e8b7c7">EventNextVCState::busy</a> );
<a name="l00546"></a>00546     <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#a0ac06a38d090b1214fb59085a13437ca">SetInput</a>( aevt-&gt;dst_vc, input );
<a name="l00547"></a>00547     <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#afa9f279d889de002aa2b9cf8064e1c35">SetInputVC</a>( aevt-&gt;dst_vc, aevt-&gt;src_vc );
<a name="l00548"></a>00548 
<a name="l00549"></a>00549     <a class="code" href="classEventRouter.html#a0174050aacf4226530757e33e33d1f70">_SendTransport</a>( input, output, aevt );
<a name="l00550"></a>00550       } <span class="keywordflow">else</span> {
<a name="l00551"></a>00551     <span class="comment">// VC busy =&gt; queue a waiting event</span>
<a name="l00552"></a>00552 
<a name="l00553"></a>00553     w = <span class="keyword">new</span> <a class="code" href="structEventNextVCState_1_1tWaiting.html">EventNextVCState::tWaiting</a>;
<a name="l00554"></a>00554 
<a name="l00555"></a>00555     w-&gt;<a class="code" href="structEventNextVCState_1_1tWaiting.html#a61868145a914514d4452779359c2862b">input</a> = input;
<a name="l00556"></a>00556     w-&gt;<a class="code" href="structEventNextVCState_1_1tWaiting.html#ae7dbb6e1f8fb7d76309cc66a7da22359">vc</a>    = aevt-&gt;src_vc;
<a name="l00557"></a>00557     w-&gt;<a class="code" href="structEventNextVCState_1_1tWaiting.html#a68dd63b3d7f1265fe3d65c3ae6e874c6">id</a>    = aevt-&gt;id;
<a name="l00558"></a>00558     w-&gt;<a class="code" href="structEventNextVCState_1_1tWaiting.html#ad92a357434764b4f66b4568c1c5d4885">watch</a> = aevt-&gt;watch;
<a name="l00559"></a>00559     w-&gt;<a class="code" href="structEventNextVCState_1_1tWaiting.html#accadafd5853b304641acd8502f258626">pres</a>  = 1;
<a name="l00560"></a>00560 
<a name="l00561"></a>00561     <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#a24c5ce18559e8430dcbb773bba1ac453">PushWaiting</a>( aevt-&gt;dst_vc, w );
<a name="l00562"></a>00562       }
<a name="l00563"></a>00563     } <span class="keywordflow">else</span> {
<a name="l00564"></a>00564       <span class="keywordflow">if</span> ( <a class="code" href="classEventRouter.html#a4989d0bf33c1b8d1f1acb26af603b952">_vct</a> ) {
<a name="l00565"></a>00565     <a class="code" href="classModule.html#acfa9d0dc518853045e0d2356d138717f">Error</a>( <span class="stringliteral">&quot;Received arrival event for non-head flit in cut-through mode&quot;</span> );
<a name="l00566"></a>00566       }
<a name="l00567"></a>00567 
<a name="l00568"></a>00568       <span class="keywordflow">if</span> ( state != <a class="code" href="classEventNextVCState.html#a2ab8c3a3d963c2317cf00080d6c6be6aa9dde2512d7f1bf17de03229200e8b7c7">EventNextVCState::busy</a> ) {
<a name="l00569"></a>00569     cout &lt;&lt; <span class="stringliteral">&quot;flit id = &quot;</span> &lt;&lt; aevt-&gt;id &lt;&lt; endl;
<a name="l00570"></a>00570     <a class="code" href="classModule.html#acfa9d0dc518853045e0d2356d138717f">Error</a>( <span class="stringliteral">&quot;Received a body flit at a non-busy output VC&quot;</span> );
<a name="l00571"></a>00571       }
<a name="l00572"></a>00572       
<a name="l00573"></a>00573       <span class="keywordflow">if</span> ( ( !<a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;IsInputWaiting( aevt-&gt;dst_vc, input, aevt-&gt;src_vc ) ) &amp;&amp;
<a name="l00574"></a>00574        ( input == <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#a798aad21ee1a5e7a4d9a6b4658dabaff">GetInput</a>( aevt-&gt;dst_vc ) ) &amp;&amp;
<a name="l00575"></a>00575        ( aevt-&gt;src_vc == <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#a023c7e9dc2ab84ea22aad16139444c4a">GetInputVC</a>( aevt-&gt;dst_vc ) ) ) {
<a name="l00576"></a>00576     <span class="comment">// Body flit part of the current active VC =&gt; queue transport event</span>
<a name="l00577"></a>00577     <span class="comment">// (the weird IsInputWaiting call handles a body flit waiting in addition</span>
<a name="l00578"></a>00578     <span class="comment">// to a head flit)</span>
<a name="l00579"></a>00579 
<a name="l00580"></a>00580     <a class="code" href="classEventRouter.html#a0174050aacf4226530757e33e33d1f70">_SendTransport</a>( input, output, aevt );
<a name="l00581"></a>00581       } <span class="keywordflow">else</span> {
<a name="l00582"></a>00582 
<a name="l00583"></a>00583     <span class="comment">// VC busy with a differnet transaction =&gt; update waiting event</span>
<a name="l00584"></a>00584     <a class="code" href="classEventRouter.html#a3d57f8b0451e0127d70812aad38ac24e">_output_state</a>[output]-&gt;<a class="code" href="classEventNextVCState.html#a521316f0b93e5ef6e19c91f42f0f6efb">IncrWaiting</a>( aevt-&gt;dst_vc, input, aevt-&gt;src_vc );
<a name="l00585"></a>00585       } 
<a name="l00586"></a>00586     }
<a name="l00587"></a>00587 
<a name="l00588"></a>00588     <span class="keyword">delete</span> aevt;
<a name="l00589"></a>00589   }
<a name="l00590"></a>00590 }
<a name="l00591"></a>00591 
<a name="l00592"></a>00592 <span class="keywordtype">void</span> <a class="code" href="classEventRouter.html#a81f11252e3cb5b1c7d205d95bdb2178f">EventRouter::_TransportRequests</a>( <span class="keywordtype">int</span> output )
<a name="l00593"></a>00593 {
<a name="l00594"></a>00594   tTransportEvent *tevt;
<a name="l00595"></a>00595   
<a name="l00596"></a>00596   <span class="keywordflow">if</span> ( !<a class="code" href="classEventRouter.html#a07aed10ad1ef0dca3fe63dc4281a7584">_transport_queue</a>[output].empty( ) ) {
<a name="l00597"></a>00597     tevt = <a class="code" href="classEventRouter.html#a07aed10ad1ef0dca3fe63dc4281a7584">_transport_queue</a>[output].front( );
<a name="l00598"></a>00598     <a class="code" href="classEventRouter.html#a6850a1bf75735c5e597b60219dc6806f">_transport_arbiter</a>[tevt-&gt;input]-&gt;<a class="code" href="classPriorityArbiter.html#a5b9ccfee25aec38cfdcc52a8399c7877">AddRequest</a>( output );
<a name="l00599"></a>00599   }
<a name="l00600"></a>00600 }
<a name="l00601"></a>00601 
<a name="l00602"></a>00602 <span class="keywordtype">void</span> <a class="code" href="classEventRouter.html#ac0ce688b9ccd655bbbd9545b3859184f">EventRouter::_TransportArb</a>( <span class="keywordtype">int</span> input ) 
<a name="l00603"></a>00603 {
<a name="l00604"></a>00604   tTransportEvent *tevt;
<a name="l00605"></a>00605 
<a name="l00606"></a>00606   <span class="keywordtype">int</span>    output;
<a name="l00607"></a>00607   <a class="code" href="classBuffer.html">Buffer</a> *cur_buf;
<a name="l00608"></a>00608   <a class="code" href="structFlit.html">Flit</a>   *f;
<a name="l00609"></a>00609   <a class="code" href="classCredit.html">Credit</a> *c;
<a name="l00610"></a>00610 
<a name="l00611"></a>00611   <span class="keywordflow">if</span> ( <a class="code" href="classEventRouter.html#ae9748e3424921fb9dc45f71c7361cca0">_transport_free</a>[input] ) {
<a name="l00612"></a>00612     <a class="code" href="classEventRouter.html#a6850a1bf75735c5e597b60219dc6806f">_transport_arbiter</a>[input]-&gt;<a class="code" href="classPriorityArbiter.html#add8ae10301b47745fabc137e21ddc2de">Arbitrate</a>( );
<a name="l00613"></a>00613     output = <a class="code" href="classEventRouter.html#a6850a1bf75735c5e597b60219dc6806f">_transport_arbiter</a>[input]-&gt;<a class="code" href="classPriorityArbiter.html#a2c2099f5e28b9ab63f2f194f2ad166dd">Match</a>( );
<a name="l00614"></a>00614   } <span class="keywordflow">else</span> {
<a name="l00615"></a>00615     output = <a class="code" href="classEventRouter.html#ae6df2e2f8d998b3395eece5c136e8975">_transport_match</a>[input];
<a name="l00616"></a>00616   }
<a name="l00617"></a>00617 
<a name="l00618"></a>00618   <span class="keywordflow">if</span> ( output != -1 ) {  
<a name="l00619"></a>00619     <span class="comment">// This completes the match from input to output =&gt;</span>
<a name="l00620"></a>00620     <span class="comment">// one flit can be transferred</span>
<a name="l00621"></a>00621 
<a name="l00622"></a>00622     tevt = <a class="code" href="classEventRouter.html#a07aed10ad1ef0dca3fe63dc4281a7584">_transport_queue</a>[output].front( );
<a name="l00623"></a>00623     
<a name="l00624"></a>00624     <span class="keywordflow">if</span> ( tevt-&gt;watch ) {
<a name="l00625"></a>00625       cout &lt;&lt; <span class="stringliteral">&quot;Processing transport event at &quot;</span> &lt;&lt; <a class="code" href="classModule.html#a0eeaa2b9a7d2ba88ab05682444898b08">FullName</a>() 
<a name="l00626"></a>00626        &lt;&lt; <span class="stringliteral">&quot; for flit &quot;</span> &lt;&lt; tevt-&gt;id &lt;&lt; endl;
<a name="l00627"></a>00627     }
<a name="l00628"></a>00628 
<a name="l00629"></a>00629     cur_buf = <a class="code" href="classEventRouter.html#a9b9e0996ceb70b9677e66b77f8555ba7">_buf</a>[input];
<a name="l00630"></a>00630     <span class="keywordtype">int</span> vc = tevt-&gt;src_vc;
<a name="l00631"></a>00631 
<a name="l00632"></a>00632     <span class="comment">// Some sanity checking first</span>
<a name="l00633"></a>00633 
<a name="l00634"></a>00634     <span class="keywordflow">if</span> ( !<a class="code" href="classEventRouter.html#aaa3e7b4d6314f8a0133cdf67c6afe62b">_active</a>[input][vc] ) {
<a name="l00635"></a>00635       <a class="code" href="classModule.html#acfa9d0dc518853045e0d2356d138717f">Error</a>( <span class="stringliteral">&quot;Non-active VC received grant.&quot;</span> );
<a name="l00636"></a>00636     }
<a name="l00637"></a>00637 
<a name="l00638"></a>00638     <span class="keywordflow">if</span> ( cur_buf-&gt;<a class="code" href="classBuffer.html#a6fc2756b845c2cd18277e14ced681d18">Empty</a>( vc ) ) {
<a name="l00639"></a>00639       <span class="keywordflow">return</span>; <span class="comment">//Error( &quot;Empty VC received grant.&quot; );</span>
<a name="l00640"></a>00640     }
<a name="l00641"></a>00641 
<a name="l00642"></a>00642     <span class="keywordflow">if</span> ( tevt-&gt;dst_vc != cur_buf-&gt;<a class="code" href="classBuffer.html#ade55f96ac295b9eeeff4b0dca2218396">GetOutputVC</a>( vc ) ) {
<a name="l00643"></a>00643       <a class="code" href="classModule.html#acfa9d0dc518853045e0d2356d138717f">Error</a>( <span class="stringliteral">&quot;Transport event&apos;s VC does not match input&apos;s destination VC.&quot;</span> );
<a name="l00644"></a>00644     }
<a name="l00645"></a>00645 
<a name="l00646"></a>00646     f = cur_buf-&gt;<a class="code" href="classBuffer.html#aeacd48250794c80d8b55e1ed7d537bd9">RemoveFlit</a>( vc );
<a name="l00647"></a>00647 
<a name="l00648"></a>00648     <span class="keywordflow">if</span> ( <a class="code" href="classEventRouter.html#a4989d0bf33c1b8d1f1acb26af603b952">_vct</a> ) {
<a name="l00649"></a>00649       <span class="keywordflow">if</span> ( f-&gt;<a class="code" href="structFlit.html#aa0f32295d57acd313ddf257127b5c850">tail</a> ) {
<a name="l00650"></a>00650     <a class="code" href="classEventRouter.html#ae9748e3424921fb9dc45f71c7361cca0">_transport_free</a>[input]  = <span class="keyword">true</span>;
<a name="l00651"></a>00651     <a class="code" href="classEventRouter.html#ae6df2e2f8d998b3395eece5c136e8975">_transport_match</a>[input] = -1;
<a name="l00652"></a>00652 
<a name="l00653"></a>00653     <a class="code" href="classEventRouter.html#a07aed10ad1ef0dca3fe63dc4281a7584">_transport_queue</a>[output].pop( );
<a name="l00654"></a>00654     <span class="keyword">delete</span> tevt;
<a name="l00655"></a>00655 
<a name="l00656"></a>00656     <a class="code" href="classEventRouter.html#aaa3e7b4d6314f8a0133cdf67c6afe62b">_active</a>[input][vc] = <span class="keyword">false</span>;
<a name="l00657"></a>00657       } <span class="keywordflow">else</span> {
<a name="l00658"></a>00658     <a class="code" href="classEventRouter.html#ae9748e3424921fb9dc45f71c7361cca0">_transport_free</a>[input]  = <span class="keyword">false</span>;
<a name="l00659"></a>00659     <a class="code" href="classEventRouter.html#ae6df2e2f8d998b3395eece5c136e8975">_transport_match</a>[input] = output;
<a name="l00660"></a>00660       }
<a name="l00661"></a>00661     } <span class="keywordflow">else</span> {
<a name="l00662"></a>00662       <a class="code" href="classEventRouter.html#ae9748e3424921fb9dc45f71c7361cca0">_transport_free</a>[input]  = <span class="keyword">true</span>;
<a name="l00663"></a>00663       <a class="code" href="classEventRouter.html#ae6df2e2f8d998b3395eece5c136e8975">_transport_match</a>[input] = -1;
<a name="l00664"></a>00664 
<a name="l00665"></a>00665       <a class="code" href="classEventRouter.html#a07aed10ad1ef0dca3fe63dc4281a7584">_transport_queue</a>[output].pop( );
<a name="l00666"></a>00666       <span class="keyword">delete</span> tevt;
<a name="l00667"></a>00667 
<a name="l00668"></a>00668       <span class="keywordflow">if</span> ( f-&gt;<a class="code" href="structFlit.html#aa0f32295d57acd313ddf257127b5c850">tail</a> ) {
<a name="l00669"></a>00669     <a class="code" href="classEventRouter.html#aaa3e7b4d6314f8a0133cdf67c6afe62b">_active</a>[input][vc] = <span class="keyword">false</span>;
<a name="l00670"></a>00670       }
<a name="l00671"></a>00671     }
<a name="l00672"></a>00672 
<a name="l00673"></a>00673     c = <a class="code" href="classCredit.html#aca569d3a3bdbe47bcfd8210d62cfae64">Credit::New</a>( );
<a name="l00674"></a>00674     c-&gt;<a class="code" href="classCredit.html#af7898eb802885a65e5270096e0595abe">vc</a>.insert(f-&gt;<a class="code" href="structFlit.html#a91f87fc20463a5fe6ea5e9e035991701">vc</a>);
<a name="l00675"></a>00675     c-&gt;<a class="code" href="classCredit.html#aba0c2a6d3e13c2c8cf9cc3bc1b9a91e2">head</a>          = f-&gt;<a class="code" href="structFlit.html#a784a6bcb041646c2b8c068b7de4bdc9a">head</a>;
<a name="l00676"></a>00676     c-&gt;<a class="code" href="classCredit.html#a003d50d1b8d6cc6283a1099263add1fb">tail</a>          = f-&gt;<a class="code" href="structFlit.html#aa0f32295d57acd313ddf257127b5c850">tail</a>;
<a name="l00677"></a>00677     c-&gt;<a class="code" href="classCredit.html#a8eb365ab33461a75c04b4932147a60e4">id</a>            = f-&gt;<a class="code" href="structFlit.html#aeae7d176eaa77ba7300abee6afbee8a4">id</a>;
<a name="l00678"></a>00678     <a class="code" href="classEventRouter.html#a1d6bb7dbab759a627ef735122becc9c2">_credit_pipe</a>-&gt;<a class="code" href="classPipelineFIFO.html#ae3c4fe8b1acbae49dc5cc8b8960fb219">Write</a>( c, input );
<a name="l00679"></a>00679     
<a name="l00680"></a>00680     <span class="keywordflow">if</span> ( f-&gt;<a class="code" href="structFlit.html#aa5328bdf6d139ea1c8e503228bf8aae5">watch</a> &amp;&amp; c-&gt;<a class="code" href="classCredit.html#a003d50d1b8d6cc6283a1099263add1fb">tail</a> ) {
<a name="l00681"></a>00681       *<a class="code" href="globals_8hpp.html#a54233075d19c60edbe29257351f7fe3d">gWatchOut</a> &lt;&lt; <a class="code" href="globals_8hpp.html#ad223077827fd15227dc1bd007980a296">GetSimTime</a>() &lt;&lt; <span class="stringliteral">&quot; | &quot;</span> &lt;&lt; <a class="code" href="classModule.html#a0eeaa2b9a7d2ba88ab05682444898b08">FullName</a>() &lt;&lt; <span class="stringliteral">&quot; | &quot;</span>
<a name="l00682"></a>00682           &lt;&lt; <a class="code" href="classModule.html#a0eeaa2b9a7d2ba88ab05682444898b08">FullName</a>() &lt;&lt; <span class="stringliteral">&quot; sending tail credit back for flit &quot;</span> &lt;&lt; f-&gt;<a class="code" href="structFlit.html#aeae7d176eaa77ba7300abee6afbee8a4">id</a> &lt;&lt; endl;
<a name="l00683"></a>00683     }
<a name="l00684"></a>00684 
<a name="l00685"></a>00685     <span class="comment">// Update and forward the flit to the crossbar</span>
<a name="l00686"></a>00686 
<a name="l00687"></a>00687     f-&gt;<a class="code" href="structFlit.html#aef504aeca60e130f76a997b6384ab8c7">hops</a>++;
<a name="l00688"></a>00688     f-&gt;<a class="code" href="structFlit.html#a91f87fc20463a5fe6ea5e9e035991701">vc</a> = cur_buf-&gt;<a class="code" href="classBuffer.html#ade55f96ac295b9eeeff4b0dca2218396">GetOutputVC</a>( vc );
<a name="l00689"></a>00689     <a class="code" href="classEventRouter.html#a270ecba4d458fe1f31eddc001e5fe2b7">_crossbar_pipe</a>-&gt;<a class="code" href="classPipelineFIFO.html#ae3c4fe8b1acbae49dc5cc8b8960fb219">Write</a>( f, output );
<a name="l00690"></a>00690 
<a name="l00691"></a>00691     <span class="keywordflow">if</span> ( f-&gt;<a class="code" href="structFlit.html#aa5328bdf6d139ea1c8e503228bf8aae5">watch</a> ) {
<a name="l00692"></a>00692       *<a class="code" href="globals_8hpp.html#a54233075d19c60edbe29257351f7fe3d">gWatchOut</a> &lt;&lt; <a class="code" href="globals_8hpp.html#ad223077827fd15227dc1bd007980a296">GetSimTime</a>() &lt;&lt; <span class="stringliteral">&quot; | &quot;</span> &lt;&lt; <a class="code" href="classModule.html#a0eeaa2b9a7d2ba88ab05682444898b08">FullName</a>() &lt;&lt; <span class="stringliteral">&quot; | &quot;</span>
<a name="l00693"></a>00693           &lt;&lt; <span class="stringliteral">&quot;Forwarding flit through crossbar at &quot;</span> &lt;&lt; <a class="code" href="classModule.html#a0eeaa2b9a7d2ba88ab05682444898b08">FullName</a>() &lt;&lt; <span class="stringliteral">&quot;:&quot;</span> &lt;&lt; endl
<a name="l00694"></a>00694           &lt;&lt; *f;
<a name="l00695"></a>00695     }  
<a name="l00696"></a>00696   }
<a name="l00697"></a>00697 }
<a name="l00698"></a>00698 
<a name="l00699"></a>00699 <span class="keywordtype">void</span> <a class="code" href="classEventRouter.html#ab7f28b9d248395419d915762271f370b">EventRouter::_OutputQueuing</a>( )
<a name="l00700"></a>00700 {
<a name="l00701"></a>00701   <a class="code" href="structFlit.html">Flit</a>   *f;
<a name="l00702"></a>00702   <a class="code" href="classCredit.html">Credit</a> *c;
<a name="l00703"></a>00703 
<a name="l00704"></a>00704   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> output = 0; output &lt; _outputs; ++output ) {
<a name="l00705"></a>00705     f = <a class="code" href="classEventRouter.html#a270ecba4d458fe1f31eddc001e5fe2b7">_crossbar_pipe</a>-&gt;<a class="code" href="classPipelineFIFO.html#a31ae4ef08ee582e33c05789230d1a3b7">Read</a>( output );
<a name="l00706"></a>00706 
<a name="l00707"></a>00707     <span class="keywordflow">if</span> ( f ) {
<a name="l00708"></a>00708       <a class="code" href="classEventRouter.html#a4fb5fb835dbffe32917c2a8d6d274e1a">_output_buffer</a>[output].push( f );
<a name="l00709"></a>00709     }
<a name="l00710"></a>00710   }  
<a name="l00711"></a>00711 
<a name="l00712"></a>00712   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> input = 0; input &lt; _inputs; ++input ) {
<a name="l00713"></a>00713     c = <a class="code" href="classEventRouter.html#a1d6bb7dbab759a627ef735122becc9c2">_credit_pipe</a>-&gt;<a class="code" href="classPipelineFIFO.html#a31ae4ef08ee582e33c05789230d1a3b7">Read</a>( input );
<a name="l00714"></a>00714 
<a name="l00715"></a>00715     <span class="keywordflow">if</span> ( c ) {
<a name="l00716"></a>00716       <a class="code" href="classEventRouter.html#a85401afc7d37556f7a1d6e7a2a1e83f0">_in_cred_buffer</a>[input].push( c );
<a name="l00717"></a>00717     }
<a name="l00718"></a>00718   }
<a name="l00719"></a>00719 }
<a name="l00720"></a>00720 
<a name="l00721"></a>00721 <span class="keywordtype">void</span> <a class="code" href="classEventRouter.html#a0514e46558ea5b05b302c0dd75421c08">EventRouter::_SendFlits</a>( )
<a name="l00722"></a>00722 {
<a name="l00723"></a>00723   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> output = 0; output &lt; _outputs; ++output ) {
<a name="l00724"></a>00724     <span class="keywordflow">if</span> ( !<a class="code" href="classEventRouter.html#a4fb5fb835dbffe32917c2a8d6d274e1a">_output_buffer</a>[output].empty( ) ) {
<a name="l00725"></a>00725       <a class="code" href="structFlit.html">Flit</a> *f = <a class="code" href="classEventRouter.html#a4fb5fb835dbffe32917c2a8d6d274e1a">_output_buffer</a>[output].front( );
<a name="l00726"></a>00726       <a class="code" href="classEventRouter.html#a4fb5fb835dbffe32917c2a8d6d274e1a">_output_buffer</a>[output].pop( );
<a name="l00727"></a>00727       <a class="code" href="classRouter.html#a1b7cba8ca8d0ad6a220d285b268c3be5">_output_channels</a>[output]-&gt;Send( f );
<a name="l00728"></a>00728     }
<a name="l00729"></a>00729   }
<a name="l00730"></a>00730 }
<a name="l00731"></a>00731 
<a name="l00732"></a>00732 <span class="keywordtype">void</span> <a class="code" href="classEventRouter.html#a886e76f6ace07c869ddf616e1e051585">EventRouter::_SendCredits</a>( )
<a name="l00733"></a>00733 {
<a name="l00734"></a>00734   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> input = 0; input &lt; _inputs; ++input ) {
<a name="l00735"></a>00735     <span class="keywordflow">if</span> ( !<a class="code" href="classEventRouter.html#a85401afc7d37556f7a1d6e7a2a1e83f0">_in_cred_buffer</a>[input].empty( ) ) {
<a name="l00736"></a>00736       <a class="code" href="classCredit.html">Credit</a> *c = <a class="code" href="classEventRouter.html#a85401afc7d37556f7a1d6e7a2a1e83f0">_in_cred_buffer</a>[input].front( );
<a name="l00737"></a>00737       <a class="code" href="classEventRouter.html#a85401afc7d37556f7a1d6e7a2a1e83f0">_in_cred_buffer</a>[input].pop( );
<a name="l00738"></a>00738       <a class="code" href="classRouter.html#aa8854c71fb1b0916a13fa1c71fb0ae93">_input_credits</a>[input]-&gt;Send( c );
<a name="l00739"></a>00739     }
<a name="l00740"></a>00740   }
<a name="l00741"></a>00741 }
<a name="l00742"></a>00742 
<a name="l00743"></a><a class="code" href="classEventRouter.html#ae75ecd56592df51900518535b5996097">00743</a> <span class="keywordtype">void</span> <a class="code" href="classEventRouter.html#acaee27c21b97c22a4f2d5339d8c38bac">EventRouter::Display</a>( ostream &amp; os )<span class="keyword"> const</span>
<a name="l00744"></a>00744 <span class="keyword"></span>{
<a name="l00745"></a>00745   <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> input = 0; input &lt; _inputs; ++input ) {
<a name="l00746"></a>00746     <a class="code" href="classEventRouter.html#a9b9e0996ceb70b9677e66b77f8555ba7">_buf</a>[input]-&gt;Display( os );
<a name="l00747"></a>00747   }
<a name="l00748"></a>00748 }
<a name="l00749"></a>00749 
<a name="l00750"></a>00750 <a class="code" href="classEventNextVCState.html#afa2b86271af0ede661776c91798d1ea0">EventNextVCState::EventNextVCState</a>( <span class="keyword">const</span> <a class="code" href="classConfiguration.html">Configuration</a>&amp; config, 
<a name="l00751"></a>00751                     <a class="code" href="classModule.html">Module</a> *parent, <span class="keyword">const</span> <span class="keywordtype">string</span>&amp; name ) :
<a name="l00752"></a>00752   <a class="code" href="classModule.html">Module</a>( parent, name )
<a name="l00753"></a>00753 {
<a name="l00754"></a>00754   _buf_size = config.<a class="code" href="classConfiguration.html#a924090a06ca73bc53ed73c5f4f2cae27">GetInt</a>( <span class="stringliteral">&quot;vc_buf_size&quot;</span> );
<a name="l00755"></a>00755   <a class="code" href="classEventRouter.html#a52586db8035c6e8f998be49230a5633d">_vcs</a>      = config.<a class="code" href="classConfiguration.html#a924090a06ca73bc53ed73c5f4f2cae27">GetInt</a>( <span class="stringliteral">&quot;num_vcs&quot;</span> );
<a name="l00756"></a>00756 
<a name="l00757"></a>00757   _credits.resize(<a class="code" href="classEventRouter.html#a52586db8035c6e8f998be49230a5633d">_vcs</a>, _buf_size);
<a name="l00758"></a>00758   _presence.resize(<a class="code" href="classEventRouter.html#a52586db8035c6e8f998be49230a5633d">_vcs</a>, 0);
<a name="l00759"></a>00759   _input.resize(<a class="code" href="classEventRouter.html#a52586db8035c6e8f998be49230a5633d">_vcs</a>);
<a name="l00760"></a>00760   _inputVC.resize(<a class="code" href="classEventRouter.html#a52586db8035c6e8f998be49230a5633d">_vcs</a>);
<a name="l00761"></a>00761   _waiting.resize(<a class="code" href="classEventRouter.html#a52586db8035c6e8f998be49230a5633d">_vcs</a>);
<a name="l00762"></a>00762   _state.resize(<a class="code" href="classEventRouter.html#a52586db8035c6e8f998be49230a5633d">_vcs</a>, idle);
<a name="l00763"></a>00763 }
<a name="l00764"></a>00764 
<a name="l00765"></a>00765 <a class="code" href="classEventNextVCState.html#a2ab8c3a3d963c2317cf00080d6c6be6a">EventNextVCState::eNextVCState</a> <a class="code" href="classEventNextVCState.html#ae7dac61505d2673c240f979e29dbe608">EventNextVCState::GetState</a>( <span class="keywordtype">int</span> vc )<span class="keyword"> const</span>
<a name="l00766"></a>00766 <span class="keyword"></span>{
<a name="l00767"></a>00767   assert( ( vc &gt;= 0 ) &amp;&amp; ( vc &lt; <a class="code" href="classEventNextVCState.html#afc461495f4bbcc5580709538b3992261">_vcs</a> ) );
<a name="l00768"></a>00768   <span class="keywordflow">return</span> <a class="code" href="classEventNextVCState.html#acb0e7ed75c25a184871281e9dd5cf75b">_state</a>[vc];
<a name="l00769"></a>00769 }
<a name="l00770"></a>00770 
<a name="l00771"></a>00771 <span class="keywordtype">int</span> <a class="code" href="classEventNextVCState.html#a5278f920c3170fcf039693b545293d22">EventNextVCState::GetPresence</a>( <span class="keywordtype">int</span> vc )<span class="keyword"> const</span>
<a name="l00772"></a>00772 <span class="keyword"></span>{
<a name="l00773"></a>00773   assert( ( vc &gt;= 0 ) &amp;&amp; ( vc &lt; <a class="code" href="classEventNextVCState.html#afc461495f4bbcc5580709538b3992261">_vcs</a> ) );
<a name="l00774"></a>00774   <span class="keywordflow">return</span> <a class="code" href="classEventNextVCState.html#a51201af42363cedc1957e810f0529b40">_presence</a>[vc];
<a name="l00775"></a>00775 }
<a name="l00776"></a>00776 
<a name="l00777"></a>00777 <span class="keywordtype">int</span> <a class="code" href="classEventNextVCState.html#a4a0966188ee4acf4127424351d7f07de">EventNextVCState::GetCredits</a>( <span class="keywordtype">int</span> vc )<span class="keyword"> const</span>
<a name="l00778"></a>00778 <span class="keyword"></span>{
<a name="l00779"></a>00779   assert( ( vc &gt;= 0 ) &amp;&amp; ( vc &lt; <a class="code" href="classEventNextVCState.html#afc461495f4bbcc5580709538b3992261">_vcs</a> ) );
<a name="l00780"></a>00780   <span class="keywordflow">return</span> <a class="code" href="classEventNextVCState.html#ae086c6edaf70b61ceec61f1cfcb89c52">_credits</a>[vc];
<a name="l00781"></a>00781 }
<a name="l00782"></a>00782 
<a name="l00783"></a>00783 <span class="keywordtype">int</span> <a class="code" href="classEventNextVCState.html#a798aad21ee1a5e7a4d9a6b4658dabaff">EventNextVCState::GetInput</a>( <span class="keywordtype">int</span> vc )<span class="keyword"> const</span>
<a name="l00784"></a>00784 <span class="keyword"></span>{
<a name="l00785"></a>00785   assert( ( vc &gt;= 0 ) &amp;&amp; ( vc &lt; <a class="code" href="classEventNextVCState.html#afc461495f4bbcc5580709538b3992261">_vcs</a> ) );
<a name="l00786"></a>00786   <span class="keywordflow">return</span> <a class="code" href="classEventNextVCState.html#a0e8c636a20b0ac474ea2e476d6e174fa">_input</a>[vc];
<a name="l00787"></a>00787 }
<a name="l00788"></a>00788 
<a name="l00789"></a>00789 <span class="keywordtype">int</span> <a class="code" href="classEventNextVCState.html#a023c7e9dc2ab84ea22aad16139444c4a">EventNextVCState::GetInputVC</a>( <span class="keywordtype">int</span> vc )<span class="keyword"> const</span>
<a name="l00790"></a>00790 <span class="keyword"></span>{
<a name="l00791"></a>00791   assert( ( vc &gt;= 0 ) &amp;&amp; ( vc &lt; <a class="code" href="classEventNextVCState.html#afc461495f4bbcc5580709538b3992261">_vcs</a> ) );
<a name="l00792"></a>00792   <span class="keywordflow">return</span> <a class="code" href="classEventNextVCState.html#a07f3987963e2e70fcd4f1eb92edfddbf">_inputVC</a>[vc];
<a name="l00793"></a>00793 }
<a name="l00794"></a>00794 
<a name="l00795"></a>00795 <span class="keywordtype">bool</span> <a class="code" href="classEventNextVCState.html#a3ce3125a7828cd7cc182e0187add2ac8">EventNextVCState::IsWaiting</a>( <span class="keywordtype">int</span> vc )<span class="keyword"> const</span>
<a name="l00796"></a>00796 <span class="keyword"></span>{
<a name="l00797"></a>00797   assert( ( vc &gt;= 0 ) &amp;&amp; ( vc &lt; <a class="code" href="classEventNextVCState.html#afc461495f4bbcc5580709538b3992261">_vcs</a> ) );
<a name="l00798"></a>00798   <span class="keywordflow">return</span> !<a class="code" href="classEventNextVCState.html#af92e431c66ec5ef090f0d35519f56b7e">_waiting</a>[vc].empty( );
<a name="l00799"></a>00799 }
<a name="l00800"></a>00800 
<a name="l00801"></a>00801 <span class="keywordtype">void</span> <a class="code" href="classEventNextVCState.html#a24c5ce18559e8430dcbb773bba1ac453">EventNextVCState::PushWaiting</a>( <span class="keywordtype">int</span> vc, tWaiting *w )
<a name="l00802"></a>00802 {
<a name="l00803"></a>00803   assert( ( vc &gt;= 0 ) &amp;&amp; ( vc &lt; <a class="code" href="classEventNextVCState.html#afc461495f4bbcc5580709538b3992261">_vcs</a> ) );
<a name="l00804"></a>00804 
<a name="l00805"></a>00805   <span class="keywordflow">if</span> ( w-&gt;watch ) {
<a name="l00806"></a>00806     cout &lt;&lt; <a class="code" href="classModule.html#a0eeaa2b9a7d2ba88ab05682444898b08">FullName</a>() &lt;&lt; <span class="stringliteral">&quot; pushing flit &quot;</span> &lt;&lt; w-&gt;id
<a name="l00807"></a>00807      &lt;&lt; <span class="stringliteral">&quot; onto a waiting queue of length &quot;</span> &lt;&lt; <a class="code" href="classEventNextVCState.html#af92e431c66ec5ef090f0d35519f56b7e">_waiting</a>[vc].size( ) &lt;&lt; endl;
<a name="l00808"></a>00808   }
<a name="l00809"></a>00809 
<a name="l00810"></a>00810   <a class="code" href="classEventNextVCState.html#af92e431c66ec5ef090f0d35519f56b7e">_waiting</a>[vc].push_back( w );
<a name="l00811"></a>00811 }
<a name="l00812"></a>00812 
<a name="l00813"></a>00813 <span class="keywordtype">void</span> <a class="code" href="classEventNextVCState.html#a521316f0b93e5ef6e19c91f42f0f6efb">EventNextVCState::IncrWaiting</a>( <span class="keywordtype">int</span> vc, <span class="keywordtype">int</span> w_input, <span class="keywordtype">int</span> w_vc )
<a name="l00814"></a>00814 {
<a name="l00815"></a>00815   list&lt;tWaiting *&gt;::iterator match;
<a name="l00816"></a>00816 
<a name="l00817"></a>00817   <span class="comment">// search for match</span>
<a name="l00818"></a>00818   <span class="keywordflow">for</span> ( match = <a class="code" href="classEventNextVCState.html#af92e431c66ec5ef090f0d35519f56b7e">_waiting</a>[vc].begin( ); match != <a class="code" href="classEventNextVCState.html#af92e431c66ec5ef090f0d35519f56b7e">_waiting</a>[vc].end( ); match++ ) {
<a name="l00819"></a>00819     <span class="keywordflow">if</span> ( ( (*match)-&gt;input == w_input ) &amp;&amp;
<a name="l00820"></a>00820      ( (*match)-&gt;vc    == w_vc ) ) <span class="keywordflow">break</span>;
<a name="l00821"></a>00821   }
<a name="l00822"></a>00822 
<a name="l00823"></a>00823   <span class="keywordflow">if</span> ( match != <a class="code" href="classEventNextVCState.html#af92e431c66ec5ef090f0d35519f56b7e">_waiting</a>[vc].end( ) ) {
<a name="l00824"></a>00824     (*match)-&gt;pres++;
<a name="l00825"></a>00825   } <span class="keywordflow">else</span> {
<a name="l00826"></a>00826     <a class="code" href="classModule.html#acfa9d0dc518853045e0d2356d138717f">Error</a>( <span class="stringliteral">&quot;Did not find match in IncrWaiting&quot;</span> );
<a name="l00827"></a>00827   }
<a name="l00828"></a>00828 }
<a name="l00829"></a>00829 
<a name="l00830"></a>00830 <span class="keywordtype">bool</span> <a class="code" href="classEventNextVCState.html#a74105e3ec3df3c9d93de8cd74dcc331c">EventNextVCState::IsInputWaiting</a>( <span class="keywordtype">int</span> vc, <span class="keywordtype">int</span> w_input, <span class="keywordtype">int</span> w_vc )<span class="keyword"> const</span>
<a name="l00831"></a>00831 <span class="keyword"></span>{
<a name="l00832"></a>00832   list&lt;tWaiting *&gt;::const_iterator match;
<a name="l00833"></a>00833   <span class="keywordtype">bool</span> r;
<a name="l00834"></a>00834 
<a name="l00835"></a>00835   <span class="comment">// search for match</span>
<a name="l00836"></a>00836   <span class="keywordflow">for</span> ( match = <a class="code" href="classEventNextVCState.html#af92e431c66ec5ef090f0d35519f56b7e">_waiting</a>[vc].begin( ); match != <a class="code" href="classEventNextVCState.html#af92e431c66ec5ef090f0d35519f56b7e">_waiting</a>[vc].end( ); match++ ) {
<a name="l00837"></a>00837     <span class="keywordflow">if</span> ( ( (*match)-&gt;input == w_input ) &amp;&amp;
<a name="l00838"></a>00838      ( (*match)-&gt;vc    == w_vc ) ) <span class="keywordflow">break</span>;
<a name="l00839"></a>00839   }
<a name="l00840"></a>00840 
<a name="l00841"></a>00841   <span class="keywordflow">if</span> ( match != <a class="code" href="classEventNextVCState.html#af92e431c66ec5ef090f0d35519f56b7e">_waiting</a>[vc].end( ) ) {
<a name="l00842"></a>00842     r = <span class="keyword">true</span>;
<a name="l00843"></a>00843   } <span class="keywordflow">else</span> {
<a name="l00844"></a>00844     r = <span class="keyword">false</span>;
<a name="l00845"></a>00845   }
<a name="l00846"></a>00846 
<a name="l00847"></a>00847   <span class="keywordflow">return</span> r;
<a name="l00848"></a>00848 }
<a name="l00849"></a>00849 
<a name="l00850"></a>00850 <a class="code" href="structEventNextVCState_1_1tWaiting.html">EventNextVCState::tWaiting</a> *<a class="code" href="classEventNextVCState.html#aecaaf0c763aefa9e77e318a8622e97ce">EventNextVCState::PopWaiting</a>( <span class="keywordtype">int</span> vc )
<a name="l00851"></a>00851 {
<a name="l00852"></a>00852   tWaiting *w;
<a name="l00853"></a>00853 
<a name="l00854"></a>00854   assert( ( vc &gt;= 0 ) &amp;&amp; ( vc &lt; <a class="code" href="classEventNextVCState.html#afc461495f4bbcc5580709538b3992261">_vcs</a> ) );
<a name="l00855"></a>00855  
<a name="l00856"></a>00856   w = <a class="code" href="classEventNextVCState.html#af92e431c66ec5ef090f0d35519f56b7e">_waiting</a>[vc].front( );
<a name="l00857"></a>00857   <a class="code" href="classEventNextVCState.html#af92e431c66ec5ef090f0d35519f56b7e">_waiting</a>[vc].pop_front( );
<a name="l00858"></a>00858 
<a name="l00859"></a>00859   <span class="keywordflow">return</span> w;
<a name="l00860"></a>00860 }
<a name="l00861"></a>00861 
<a name="l00862"></a>00862 <span class="keywordtype">void</span> <a class="code" href="classEventNextVCState.html#a7d99ddd073957763deb9bbe9faa9e2b0">EventNextVCState::SetState</a>( <span class="keywordtype">int</span> vc, eNextVCState state )
<a name="l00863"></a>00863 {
<a name="l00864"></a>00864   assert( ( vc &gt;= 0 ) &amp;&amp; ( vc &lt; <a class="code" href="classEventNextVCState.html#afc461495f4bbcc5580709538b3992261">_vcs</a> ) );
<a name="l00865"></a>00865   <a class="code" href="classEventNextVCState.html#acb0e7ed75c25a184871281e9dd5cf75b">_state</a>[vc] = state;
<a name="l00866"></a>00866 }
<a name="l00867"></a>00867 
<a name="l00868"></a>00868 <span class="keywordtype">void</span> <a class="code" href="classEventNextVCState.html#a5bb6ddfb217018585c31ddfa2c281914">EventNextVCState::SetCredits</a>( <span class="keywordtype">int</span> vc, <span class="keywordtype">int</span> value )
<a name="l00869"></a>00869 {
<a name="l00870"></a>00870   assert( ( vc &gt;= 0 ) &amp;&amp; ( vc &lt; <a class="code" href="classEventNextVCState.html#afc461495f4bbcc5580709538b3992261">_vcs</a> ) );
<a name="l00871"></a>00871   <a class="code" href="classEventNextVCState.html#ae086c6edaf70b61ceec61f1cfcb89c52">_credits</a>[vc] = value;
<a name="l00872"></a>00872 }
<a name="l00873"></a>00873 
<a name="l00874"></a>00874 <span class="keywordtype">void</span> <a class="code" href="classEventNextVCState.html#aac2de39272d6f99e976c0e5a09146442">EventNextVCState::SetPresence</a>( <span class="keywordtype">int</span> vc, <span class="keywordtype">int</span> value )
<a name="l00875"></a>00875 {
<a name="l00876"></a>00876   assert( ( vc &gt;= 0 ) &amp;&amp; ( vc &lt; <a class="code" href="classEventNextVCState.html#afc461495f4bbcc5580709538b3992261">_vcs</a> ) );
<a name="l00877"></a>00877   <a class="code" href="classEventNextVCState.html#a51201af42363cedc1957e810f0529b40">_presence</a>[vc] = value;
<a name="l00878"></a>00878 }
<a name="l00879"></a>00879 
<a name="l00880"></a>00880 <span class="keywordtype">void</span> <a class="code" href="classEventNextVCState.html#a0ac06a38d090b1214fb59085a13437ca">EventNextVCState::SetInput</a>( <span class="keywordtype">int</span> vc, <span class="keywordtype">int</span> input )
<a name="l00881"></a>00881 {
<a name="l00882"></a>00882   assert( ( vc &gt;= 0 ) &amp;&amp; ( vc &lt; <a class="code" href="classEventNextVCState.html#afc461495f4bbcc5580709538b3992261">_vcs</a> ) );
<a name="l00883"></a>00883   <a class="code" href="classEventNextVCState.html#a0e8c636a20b0ac474ea2e476d6e174fa">_input</a>[vc] = input;
<a name="l00884"></a>00884 }
<a name="l00885"></a>00885 
<a name="l00886"></a>00886 <span class="keywordtype">void</span> <a class="code" href="classEventNextVCState.html#afa9f279d889de002aa2b9cf8064e1c35">EventNextVCState::SetInputVC</a>( <span class="keywordtype">int</span> vc, <span class="keywordtype">int</span> in_vc )
<a name="l00887"></a>00887 {
<a name="l00888"></a>00888   assert( ( vc &gt;= 0 ) &amp;&amp; ( vc &lt; <a class="code" href="classEventNextVCState.html#afc461495f4bbcc5580709538b3992261">_vcs</a> ) );
<a name="l00889"></a>00889   <a class="code" href="classEventNextVCState.html#a07f3987963e2e70fcd4f1eb92edfddbf">_inputVC</a>[vc] = in_vc;
<a name="l00890"></a>00890 }
</pre></div></div>
<!--- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&nbsp;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&nbsp;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&nbsp;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&nbsp;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&nbsp;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&nbsp;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&nbsp;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&nbsp;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&nbsp;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&nbsp;</span>Friends</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<hr size="1"/><address style="text-align: right;"><small>Generated on 13 May 2014 for GPGPU-Sim by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
